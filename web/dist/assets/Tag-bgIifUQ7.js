import{j as e,m as v,D as P,r as l,a4 as W,a5 as A,A as I,z as j,a6 as L}from"./index-vyLcd-Je.js";import{T as O,F as q}from"./FormDialog-4Nls6tjn.js";import{s as C}from"./style-oIRJWkRv.js";import{T as D}from"./TextField-ExYO2cNO.js";import{P as z}from"./Grow-AEneWTZ1.js";import{T as G,a as J,b as K,c as f,d as h,e as M,f as Q}from"./TableRow-MEti22uE.js";import{B as p}from"./Button-P3xriBeC.js";import{b as U}from"./Select-SR092O4V.js";import"./DialogActions-TfqgKDOq.js";import"./useTheme-gj9g8ZO4.js";import"./KeyboardArrowRight-okvb3hby.js";import"./MenuItem-XkAApCKL.js";const V=({Info:t,setInfo:s})=>e.jsx(e.Fragment,{children:e.jsx(D,{autoFocus:!0,margin:"dense",id:"tag-name",label:"标签名称",fullWidth:!0,value:t.name,onChange:n=>s({...t,name:n.target.value})})}),X=[{id:"name",label:"标签名称",minWidth:170},{id:"operation",label:"操作",minWidth:170}];function Y({tagList:t,updateTagList:s}){const n=v(C)(),{enqueueSnackbar:i}=P(),[c,d]=l.useState(0),[o,m]=l.useState(10),[k,x]=l.useState(!1),[$,T]=l.useState(!1),[r,u]=l.useState({id:0,name:""}),S=V({Info:r,setInfo:u}),w="确定要删除这个标签吗？",y="如果不想删除可以点击取消",H=a=>{u(a),x(!0)},N=()=>{x(!1)},B=l.useCallback(async()=>{const a=await W(r);if(a.code!=="200"){i(`标签: ${r.name}修改失败${a.msg}`,{autoHideDuration:3e3,variant:"error"});return}return s(),i(`标签: ${r.name} 修改成功${a.msg}`,{autoHideDuration:3e3,variant:"success"}),!0},[r]),F=l.useCallback(async()=>{const a=await A(r.id);if(a.code!=="200"){i(`标签: ${r.name}删除失败${a.msg}`,{autoHideDuration:3e3,variant:"error"});return}s(),i(`标签: ${r.name} 已被删除`,{autoHideDuration:3e3,variant:"success"})},[r]),R=(a,g)=>{d(g)},E=a=>{m(+a.target.value),d(0)};return e.jsxs(z,{className:n.rootTable,children:[e.jsx(G,{className:n.container,children:e.jsxs(J,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(K,{children:e.jsx(f,{children:X.map(a=>e.jsx(h,{align:"center",style:{minWidth:a.minWidth},children:a.label},a.id))})}),e.jsx(M,{children:t&&t.slice(c*o,c*o+o).map(a=>e.jsxs(f,{hover:!0,role:"checkbox",tabIndex:-1,children:[e.jsx(h,{align:"center",children:a.name},a.name),e.jsxs(h,{align:"center",children:[e.jsx(p,{className:n.editBtn,onClick:()=>{u(a),T(!0)},children:"编辑"}),e.jsx(p,{className:n.deleteButton,onClick:()=>H(a),children:"删除"})]})]},a.name))})]})}),e.jsx(Q,{rowsPerPageOptions:[10,25,100],component:"div",labelRowsPerPage:"每页行数:",labelDisplayedRows:({from:a,to:g,count:b})=>`${a}-${g} 总数 ${b!==-1?b:0}`,count:t.length,rowsPerPage:o,page:c,onPageChange:R,onRowsPerPageChange:E}),e.jsx(O,{open:k,title:w,text:y,toClose:N,todo:F}),e.jsx(q,{open:$,content:S,toClose:()=>T(!1),title:"编辑标签信息",todo:B})]})}const Z=(t,s)=>({...s,tagList:t.tagList}),_={initTag:j.initTagInfo,updateTagList:j.updateTagList},ee=t=>{const s=v(C)(),{enqueueSnackbar:n}=P(),[i,c]=l.useState(""),d=async()=>{if(!i){n("标签名称不能为空",{autoHideDuration:3e3,variant:"warning"});return}if(t.tagList.some(m=>m.name===i)){n("该标签已存在！",{autoHideDuration:3e3,variant:"warning"});return}const o=await L(i);if(o.code!=="200"){n(`标签添加失败${o.msg}`,{autoHideDuration:3e3,variant:"error"});return}t.updateTagList(),n(`标签: ${o.data.name}添加成功！`,{autoHideDuration:3e3,variant:"success"})};return e.jsxs("div",{className:s.itemPage,children:[e.jsxs("div",{className:s.ControlBox,children:[e.jsx(U,{className:s.Control,children:e.jsx(D,{size:"small",id:"tag-name",label:"标签名称",variant:"outlined",value:i,onChange:o=>c(o.target.value)})}),e.jsx(p,{className:s.addButton,onClick:d,children:"添加标签"})]}),e.jsx("div",{className:s.shellBox,children:e.jsx(Y,{...t})})]})},ge=I(Z,_)(ee);export{ge as default};
