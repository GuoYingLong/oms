import{b as me,g as xe,c as te,_ as w,j as a,s as H,Y as S,r as m,u as fe,aa as Ae,d as X,Z as A,e as ve,f as he,i as V,h as ye,m as be,A as He,z as W,D as We,at as Ee,au as Fe,av as Ge,aw as Ve,ax as Je,ay as qe,az as Ue,aA as Ye}from"./index-vyLcd-Je.js";import{F as le,L as ce,u as Xe,c as de,d as Ze,e as Ke,B as je,f as Qe,h as et,i as tt,j as at,D as ot,k as it,O as st,G as M}from"./index-BvM0tQE_.js";import{D as rt,T as nt,F as lt}from"./FormDialog-4Nls6tjn.js";import{T as Y}from"./TextField-ExYO2cNO.js";import{b as E,I as F,S as G}from"./Select-SR092O4V.js";import{M as I}from"./MenuItem-XkAApCKL.js";import{d as ct,a as dt}from"./DeleteForever-qLBkdhrL.js";import{r as Ce}from"./createSvgIcon-REPnXX8o.js";import{x as pt,a as ut}from"./xterm-addon-fit-Kh6Ly0p6.js";import{D as gt,a as mt,c as xt}from"./DialogActions-TfqgKDOq.js";import{B as $e}from"./Button-P3xriBeC.js";import{u as ft}from"./useControlled-AZyJHjwc.js";import{c as we}from"./createSvgIcon-Wj1pg0ep.js";import{B as vt}from"./ButtonBase-JuvOKhC4.js";import{B as ht}from"./Modal-WZGSkPqe.js";import{C as pe}from"./Card-ZBbaDw8s.js";import{T as O}from"./Tooltip-BizDiQoP.js";import"./Portal-fdJRnxBE.js";import"./index-gPguApf8.js";import"./TextField-WpV9j2Nf.js";import"./Tooltip-uuOg3L5G.js";import"./useIsFocusVisible-4p8xcV5K.js";import"./KeyboardArrowRight-b8CMt5WL.js";import"./useTheme-gj9g8ZO4.js";import"./Grow-AEneWTZ1.js";function yt(e){return me("MuiPagination",e)}xe("MuiPagination",["root","ul","outlined","text"]);const bt=["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"];function jt(e={}){const{boundaryCount:t=1,componentName:i="usePagination",count:r=1,defaultPage:n=1,disabled:s=!1,hideNextButton:v=!1,hidePrevButton:l=!1,onChange:b,page:j,showFirstButton:h=!1,showLastButton:C=!1,siblingCount:p=1}=e,y=te(e,bt),[d,c]=ft({controlled:j,default:n,name:i,state:"page"}),u=(f,z)=>{j||c(z),b&&b(f,z)},L=(f,z)=>{const J=z-f+1;return Array.from({length:J},(re,q)=>f+q)},D=L(1,Math.min(t,r)),_=L(Math.max(r-t+1,t+1),r),B=Math.max(Math.min(d-p,r-t-p*2-1),t+2),k=Math.min(Math.max(d+p,t+p*2+2),_.length>0?_[0]-2:r-1),T=[...h?["first"]:[],...l?[]:["previous"],...D,...B>t+2?["start-ellipsis"]:t+1<r-t?[t+1]:[],...L(B,k),...k<r-t-1?["end-ellipsis"]:r-t>t?[r-t]:[],..._,...v?[]:["next"],...C?["last"]:[]],x=f=>{switch(f){case"first":return 1;case"previous":return d-1;case"next":return d+1;case"last":return r;default:return null}},R=T.map(f=>typeof f=="number"?{onClick:z=>{u(z,f)},type:"page",page:f,selected:f===d,disabled:s,"aria-current":f===d?"true":void 0}:{onClick:z=>{u(z,x(f))},type:f,page:x(f),selected:!1,disabled:s||f.indexOf("ellipsis")===-1&&(f==="next"||f==="last"?d>=r:d<=1)});return w({items:R},y)}function Ct(e){return me("MuiPaginationItem",e)}const $t=xe("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon","colorPrimary","colorSecondary"]),N=$t,ue=we(a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),ge=we(a.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext"),wt=["className","color","component","components","disabled","page","selected","shape","size","slots","type","variant"],_e=(e,t)=>{const{ownerState:i}=e;return[t.root,t[i.variant],t[`size${A(i.size)}`],i.variant==="text"&&t[`text${A(i.color)}`],i.variant==="outlined"&&t[`outlined${A(i.color)}`],i.shape==="rounded"&&t.rounded,i.type==="page"&&t.page,(i.type==="start-ellipsis"||i.type==="end-ellipsis")&&t.ellipsis,(i.type==="previous"||i.type==="next")&&t.previousNext,(i.type==="first"||i.type==="last")&&t.firstLast]},_t=e=>{const{classes:t,color:i,disabled:r,selected:n,size:s,shape:v,type:l,variant:b}=e,j={root:["root",`size${A(s)}`,b,v,i!=="standard"&&`color${A(i)}`,i!=="standard"&&`${b}${A(i)}`,r&&"disabled",n&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[l]],icon:["icon"]};return ve(j,Ct,t)},Pt=H("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:_e})(({theme:e,ownerState:t})=>w({},e.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,height:"auto",[`&.${N.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},t.size==="small"&&{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},t.size==="large"&&{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)})),Lt=H(vt,{name:"MuiPaginationItem",slot:"Root",overridesResolver:_e})(({theme:e,ownerState:t})=>w({},e.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,[`&.${N.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${N.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},transition:e.transitions.create(["color","background-color"],{duration:e.transitions.duration.short}),"&:hover":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${N.selected}`]:{backgroundColor:(e.vars||e).palette.action.selected,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:S(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${N.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:S(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)},[`&.${N.disabled}`]:{opacity:1,color:(e.vars||e).palette.action.disabled,backgroundColor:(e.vars||e).palette.action.selected}}},t.size==="small"&&{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},t.size==="large"&&{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)},t.shape==="rounded"&&{borderRadius:(e.vars||e).shape.borderRadius}),({theme:e,ownerState:t})=>w({},t.variant==="text"&&{[`&.${N.selected}`]:w({},t.color!=="standard"&&{color:(e.vars||e).palette[t.color].contrastText,backgroundColor:(e.vars||e).palette[t.color].main,"&:hover":{backgroundColor:(e.vars||e).palette[t.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[t.color].main}},[`&.${N.focusVisible}`]:{backgroundColor:(e.vars||e).palette[t.color].dark}},{[`&.${N.disabled}`]:{color:(e.vars||e).palette.action.disabled}})},t.variant==="outlined"&&{border:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${N.selected}`]:w({},t.color!=="standard"&&{color:(e.vars||e).palette[t.color].main,border:`1px solid ${e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / 0.5)`:S(e.palette[t.color].main,.5)}`,backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.activatedOpacity})`:S(e.palette[t.color].main,e.palette.action.activatedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / calc(${e.vars.palette.action.activatedOpacity} + ${e.vars.palette.action.focusOpacity}))`:S(e.palette[t.color].main,e.palette.action.activatedOpacity+e.palette.action.focusOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${N.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / calc(${e.vars.palette.action.activatedOpacity} + ${e.vars.palette.action.focusOpacity}))`:S(e.palette[t.color].main,e.palette.action.activatedOpacity+e.palette.action.focusOpacity)}},{[`&.${N.disabled}`]:{borderColor:(e.vars||e).palette.action.disabledBackground,color:(e.vars||e).palette.action.disabled}})})),Rt=H("div",{name:"MuiPaginationItem",slot:"Icon",overridesResolver:(e,t)=>t.icon})(({theme:e,ownerState:t})=>w({fontSize:e.typography.pxToRem(20),margin:"0 -8px"},t.size==="small"&&{fontSize:e.typography.pxToRem(18)},t.size==="large"&&{fontSize:e.typography.pxToRem(22)})),Nt=m.forwardRef(function(t,i){const r=fe({props:t,name:"MuiPaginationItem"}),{className:n,color:s="standard",component:v,components:l={},disabled:b=!1,page:j,selected:h=!1,shape:C="circular",size:p="medium",slots:y={},type:d="page",variant:c="text"}=r,u=te(r,wt),L=w({},r,{color:s,disabled:b,selected:h,shape:C,size:p,type:d,variant:c}),D=Ae(),_=_t(L),k=(D.direction==="rtl"?{previous:y.next||l.next||ge,next:y.previous||l.previous||ue,last:y.first||l.first||le,first:y.last||l.last||ce}:{previous:y.previous||l.previous||ue,next:y.next||l.next||ge,first:y.first||l.first||le,last:y.last||l.last||ce})[d];return d==="start-ellipsis"||d==="end-ellipsis"?a.jsx(Pt,{ref:i,ownerState:L,className:X(_.root,n),children:"…"}):a.jsxs(Lt,w({ref:i,ownerState:L,component:v,disabled:b,className:X(_.root,n)},u,{children:[d==="page"&&j,k?a.jsx(Rt,{as:k,ownerState:L,className:_.icon}):null]}))}),kt=Nt,zt=["boundaryCount","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"],Dt=e=>{const{classes:t,variant:i}=e;return ve({root:["root",i],ul:["ul"]},yt,t)},Bt=H("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t[i.variant]]}})({}),Tt=H("ul",{name:"MuiPagination",slot:"Ul",overridesResolver:(e,t)=>t.ul})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function Mt(e,t,i){return e==="page"?`${i?"":"Go to "}page ${t}`:`Go to ${e} page`}const It=m.forwardRef(function(t,i){const r=fe({props:t,name:"MuiPagination"}),{boundaryCount:n=1,className:s,color:v="standard",count:l=1,defaultPage:b=1,disabled:j=!1,getItemAriaLabel:h=Mt,hideNextButton:C=!1,hidePrevButton:p=!1,renderItem:y=R=>a.jsx(kt,w({},R)),shape:d="circular",showFirstButton:c=!1,showLastButton:u=!1,siblingCount:L=1,size:D="medium",variant:_="text"}=r,B=te(r,zt),{items:k}=jt(w({},r,{componentName:"Pagination"})),T=w({},r,{boundaryCount:n,color:v,count:l,defaultPage:b,disabled:j,getItemAriaLabel:h,hideNextButton:C,hidePrevButton:p,renderItem:y,shape:d,showFirstButton:c,showLastButton:u,siblingCount:L,size:D,variant:_}),x=Dt(T);return a.jsx(Bt,w({"aria-label":"pagination navigation",className:X(x.root,s),ownerState:T,ref:i},B,{children:a.jsx(Tt,{className:x.ul,ownerState:T,children:k.map((R,f)=>a.jsx("li",{children:y(w({},R,{color:v,"aria-label":h(R.type,R.page,R.selected),shape:d,size:D,variant:_}))},f))})}))}),Ot=It,St=e=>({root:{flexGrow:1,display:"flex",height:"100%",width:"100%",indicator:{"& > span":{maxWidth:40,width:"100%",backgroundColor:"#4bce21"}}},itemPage:{width:"100%",height:"100%"},ControlBox:{marginBottom:"20px",width:"100%",display:"flex",alignContent:"space-evenly",alignItems:"center",justifyContent:"space-between"},Control:{width:"15%"},shellBox:{width:"100%",height:"90%"},TabPanel:{height:"100%",width:"100%"},tabs:{width:"240px",borderRight:`1px solid ${e.palette.divider}`},rootTable:{width:"100%",height:"100%"},container:{height:"92%"},deleteButton:{marginRight:"14px",backgroundColor:e.palette.error[e.palette.type],"&:hover":{backgroundColor:e.palette.error.main}},editBtn:{marginRight:"14px",backgroundColor:e.palette.warning[e.palette.type],"&:hover":{backgroundColor:e.palette.warning.main}},starBtn:{marginRight:"14px",backgroundColor:e.palette.primary[e.palette.type],"&:hover":{backgroundColor:e.palette.primary.main}},reStarBtn:{marginRight:"14px",backgroundColor:e.palette.info[e.palette.type],"&:hover":{backgroundColor:e.palette.info.main}},stopBtn:{marginRight:"14px",backgroundColor:e.palette.secondary[e.palette.type],"&:hover":{backgroundColor:e.palette.secondary.main}},addButton:{backgroundColor:e.palette.success[e.palette.type],"&:hover":{backgroundColor:e.palette.success.main}}}),At=({Info:e,setInfo:t,execute:i,playerList:r})=>{const n=i[e.execute_type];return a.jsxs(a.Fragment,{children:[a.jsx(Y,{autoFocus:!0,margin:"dense",id:"job-spec",label:"cron表达式",placeholder:"例: */10 * * * * *",fullWidth:!0,value:e.spec,onChange:s=>t({...e,spec:s.target.value})}),a.jsxs(E,{style:{width:"100%"},children:[a.jsx(F,{id:"job-select-target-type",children:"选择执行对象类型"}),a.jsxs(G,{labelId:"job-select-label",id:"job-select",value:e.execute_type,onChange:s=>t({...e,execute_type:s.target.value}),children:[a.jsx(I,{value:"host",children:"主机"}),a.jsx(I,{value:"group",children:"分组"}),a.jsx(I,{value:"tag",children:"标签"})]})]}),a.jsxs(E,{style:{width:"100%"},children:[a.jsx(F,{id:"job-select-target",children:"选择执行对象"}),a.jsx(G,{labelId:"hostid-select-label",id:"hostid-select",value:e.execute_id,onChange:s=>t({...e,execute_id:s.target.value}),children:n==null?void 0:n.map(s=>a.jsx(I,{value:s.id,children:s.name},s.id))})]}),a.jsxs(E,{style:{width:"100%"},children:[a.jsx(F,{id:"job-select-cmd-type",children:"选择命令类型"}),a.jsxs(G,{labelId:"job-select-label",id:"job-select",value:e.cmd_type,onChange:s=>t({...e,cmd_type:s.target.value}),children:[a.jsx(I,{value:"cmd",children:"cmd"}),a.jsx(I,{value:"player",children:"剧本"})]})]}),e.cmd_type==="cmd"?a.jsx(Y,{autoFocus:!0,margin:"dense",id:"job-cmd",label:"cmd命令",fullWidth:!0,value:e.cmd,onChange:s=>t({...e,cmd:s.target.value})}):a.jsxs(E,{style:{width:"100%"},children:[a.jsx(F,{id:"job-select-target",children:"选择剧本"}),a.jsx(G,{labelId:"hostid-select-label",id:"hostid-select",value:e.cmd_id,onChange:s=>t({...e,cmd_id:s.target.value}),children:r==null?void 0:r.map(s=>a.jsx(I,{value:s.id,children:s.name},s.id))})]}),a.jsx(Y,{autoFocus:!0,margin:"dense",id:"job-name",label:"任务名称",fullWidth:!0,value:e.name,onChange:s=>t({...e,name:s.target.value})})]})};var ae={},Ht=V,Wt=ye;Object.defineProperty(ae,"__esModule",{value:!0});var Z=ae.default=void 0,Et=Wt(m),Ft=Ht(he()),Gt=(0,Ft.default)(Et.createElement("path",{d:"M13 3h-2v10h2V3zm4.83 2.17l-1.42 1.42C17.99 7.86 19 9.81 19 12c0 3.87-3.13 7-7 7s-7-3.13-7-7c0-2.19 1.01-4.14 2.58-5.42L6.17 5.17C4.23 6.82 3 9.26 3 12c0 4.97 4.03 9 9 9s9-4.03 9-9c0-2.74-1.23-5.18-3.17-6.83z"}),"PowerSettingsNew");Z=ae.default=Gt;var oe={},Vt=V,Jt=ye;Object.defineProperty(oe,"__esModule",{value:!0});var K=oe.default=void 0,qt=Jt(m),Ut=Vt(he()),Yt=(0,Ut.default)(qt.createElement("path",{d:"M17 10H7v2h10v-2zm2-7h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zm-5-5H7v2h7v-2z"}),"EventNote");K=oe.default=Yt;var ie={},Xt=V;Object.defineProperty(ie,"__esModule",{value:!0});var Pe=ie.default=void 0,Zt=Xt(Ce()),Kt=a;Pe=ie.default=(0,Zt.default)((0,Kt.jsx)("path",{d:"M8 5v14l11-7z"}),"PlayArrow");const Qt=e=>({dialogTitle:{backgroundColor:e.palette.primary[e.palette.type]},dialogContent:{overflowY:"auto",boxSizing:"border-box",whiteSpace:"pre-wrap",wordWrap:"break-word",paddingLeft:"20px"},scrollbars:{minHeight:"500px",maxHeight:"100%"},dialogActions:{display:"flex",justifyContent:"space-around",alignItems:"center"},dialogActionButton:{backgroundColor:e.palette.primary[e.palette.type]}});function ea({open:e=!1,title:t,text:i="",toClose:r}){const n=be(Qt)(),s=m.useRef(null);m.useEffect(()=>{const l=new pt.Terminal,b=new ut.FitAddon;l.loadAddon(b);const j=setTimeout(()=>{s.current&&(l.open(document.getElementById("logTerminal")),l.writeln(i)),b.fit()},60),h=()=>{b.fit()};return window.addEventListener("resize",h),()=>{clearTimeout(j),l.dispose(),window.removeEventListener("resize",h)}},[e,s]);const v=()=>{r&&r()};return a.jsxs(gt,{open:e,onClose:v,fullWidth:!0,maxWidth:"md",children:[a.jsx(rt,{className:n.dialogTitle,children:t}),a.jsx(mt,{children:a.jsx("div",{id:"logTerminal",ref:s})}),a.jsx(xt,{className:n.dialogActions,children:a.jsx($e,{onClick:v,className:n.dialogActionButton,children:"关闭"})})]})}function ta(){const e=Xe(),t=de(e,Ze),i=de(e,Ke);return a.jsx(Ot,{color:"primary",count:i,page:t+1,onChange:(r,n)=>e.current.setPage(n-1)})}const aa=H("div")(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%","& .ant-empty-img-1":{fill:e.palette.mode==="light"?"#aeb8c2":"#262626"},"& .ant-empty-img-2":{fill:e.palette.mode==="light"?"#f5f5f7":"#595959"},"& .ant-empty-img-3":{fill:e.palette.mode==="light"?"#dce0e6":"#434343"},"& .ant-empty-img-4":{fill:e.palette.mode==="light"?"#fff":"#1c1c1c"},"& .ant-empty-img-5":{fillOpacity:e.palette.mode==="light"?"0.8":"0.08",fill:e.palette.mode==="light"?"#f5f5f5":"#fff"}}));function oa({msg:e}){return a.jsxs(aa,{children:[a.jsx("svg",{width:"120",height:"100",viewBox:"0 0 184 152","aria-hidden":!0,focusable:"false",children:a.jsxs("g",{fill:"none",fillRule:"evenodd",children:[a.jsxs("g",{transform:"translate(24 31.67)",children:[a.jsx("ellipse",{className:"ant-empty-img-5",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),a.jsx("path",{className:"ant-empty-img-1",d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z"}),a.jsx("path",{className:"ant-empty-img-2",d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z"}),a.jsx("path",{className:"ant-empty-img-3",d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z"})]}),a.jsx("path",{className:"ant-empty-img-3",d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z"}),a.jsxs("g",{className:"ant-empty-img-4",transform:"translate(149.65 15.383)",children:[a.jsx("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),a.jsx("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"})]})]})}),a.jsx(je,{sx:{mt:1},children:e})]})}var se={},ia=V;Object.defineProperty(se,"__esModule",{value:!0});var Le=se.default=void 0,sa=ia(Ce()),ra=a;Le=se.default=(0,sa.default)((0,ra.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"}),"Replay");function na({onReLoad:e}){return a.jsxs(Qe,{children:[a.jsx(et,{}),a.jsx(tt,{}),a.jsx(at,{}),a.jsx(ht,{startIcon:a.jsx(Le,{}),onClick:e,children:"刷新"})]})}function la(e){const{columns:t,dataId:i,getDataApi:r,updateRows:n,rows:s}=e,[v,l]=m.useState([]),[b,j]=m.useState("暂无数据..."),[h,C]=m.useState({no:0,size:10,total:0});m.useEffect(()=>{r(10,1,i).then(c=>{if(c.code!=="200"){n?n([]):l([]),j(c.msg);return}n?n(c.data.data):l(c.data.data),C({...h,no:c.data.page_num-1,total:c.data.total})})},[i]);const p=m.useCallback(async()=>{const c=await r(h.size,1,i);if(c.code!=="200"){n?n([]):l([]),j(c.msg);return}n?n(c.data.data):l(c.data.data),C({...h,no:c.data.page_num-1,total:c.data.total})},[i]),y=async c=>{const u=await r(h.size,c+1,i);if(u.code!=="200"){n?n([]):l([]),j(u.msg);return}n?n(u.data.data):l(u.data.data),C({...h,no:u.data.page_num-1,total:u.data.total})},d=async c=>{const u=await r(c,h.no+1,i);if(u.code!=="200"){n?n([]):l([]),j(u.msg);return}n?n(u.data.data):l(u.data.data),C({size:c,no:u.data.page_num-1,total:u.data.total})};return a.jsx(je,{sx:{height:"100%",width:"100%"},children:a.jsx(ot,{rows:s||v,columns:t,pagination:!0,pageSize:h.size,rowsPerPageOptions:[10,50,100],rowCount:h.total,paginationMode:"server",onPageChange:y,onPageSizeChange:d,page:h.no,components:{Toolbar:na,Pagination:ta,NoRowsOverlay:oa},componentsProps:{noRowsOverlay:{msg:b},toolbar:{onReLoad:p}},localeText:it})})}const ca=(e,t)=>({...t,jobList:e.jobList,hostList:e.hostList,tagList:e.tagList,groupList:e.groupList,playerList:e.playerList}),da={updateJobList:W.updateJobList,updateGroupList:W.updateGroupList,updateTagList:W.updateTagList,updatePlayerInfo:W.initPlayerInfo,updateHostList:W.getHostList};function Q(){return{open:!1,title:"",todo:!0}}function pa(e,t){switch(t.type){case"open":return{...e,open:!0};case"close":return{...e,open:!1};case"todo":return{...e,todo:t.payload};case"title":return{...e,title:t.payload};case"reset":return Q();default:throw new Error}}function ee(){return{open:!1,text:"",title:"",todo:!0}}function ua(e,t){switch(t.type){case"open":return{...e,open:!0};case"close":return{...e,open:!1};case"text":return{...e,text:t.payload};case"title":return{...e,title:t.payload};case"todo":return{...e,todo:t.payload};case"reset":return ee();default:throw new Error}}const ga=e=>{const{hostList:t,jobList:i,tagList:r,groupList:n,playerList:s,updateJobList:v,updateGroupList:l,updateTagList:b,updateHostList:j,updatePlayerInfo:h}=e;m.useEffect(()=>{v(),l(),b(),j(),h()},[]);const C=be(St)(),{enqueueSnackbar:p}=We(),[y,d]=m.useReducer(pa,Q(),Q),[c,u]=m.useReducer(ua,ee(),ee),[L,D]=m.useState(!1),[_,B]=m.useState(""),[k,T]=m.useState(0),[x,R]=m.useState({id:0,name:"",type:"cron",spec:"",cmd:"",status:"",cmd_type:"cmd",cmd_id:0,execute_type:"host",execute_id:0});m.useEffect(()=>{try{const o=f.current;o&&(o.scrollTop=o.scrollHeight)}catch(o){console.log(o)}},[k]);const f=m.useRef(null),z={host:t,group:n,tag:r},J=At({Info:x,setInfo:R,execute:z,playerList:s}),re=async o=>{const{id:g,name:P}=o,$=await Je(g);if(v(),$.code!=="200"){p(`任务: ${P} 启动失败${$.msg}`,{autoHideDuration:3e3,variant:"error"});return}p(`任务: ${P} 启动成功${$.msg}`,{autoHideDuration:3e3,variant:"success"})},q=async o=>{const{id:g,name:P}=o,$=await qe(g);if(v(),$.code!=="200"){p(`任务: ${P} 执行失败${$.msg}`,{autoHideDuration:3e3,variant:"error"});return}p(`任务: ${P} 执行成功${$.msg}`,{autoHideDuration:3e3,variant:"success"})},Re=async o=>{const{id:g,name:P}=o,$=await Ue(g);if($.code!=="200"){p(`任务: ${P} 停止失败${$.msg}`,{autoHideDuration:3e3,variant:"error"});return}v(),p(`任务: ${P} 停止成功${$.msg}`,{autoHideDuration:3e3,variant:"success"})},Ne=o=>{const{id:g}=o;T(g)},ke=async o=>{const g=await Ye(o);if(g.code!=="200"){p(`id: ${o} 日志信息获取失败${g.msg}`,{autoHideDuration:3e3,variant:"error"});return}B(g.data),D(!0)},ze=m.useCallback(()=>{D(!1)},[_]),De=m.useCallback(async o=>{const g=await Ee(o.id);if(g.code!=="200"){p(`任务: ${o.name}删除失败${g.msg}`,{autoHideDuration:3e3,variant:"error"});return}v(),p(`任务: ${o.name} 已被删除`,{autoHideDuration:3e3,variant:"success"})},[x]),Be=m.useCallback(async()=>{const o=await Fe(x);if(o.code!=="200"){p(`任务: ${x.name}修改失败${o.msg}`,{autoHideDuration:3e3,variant:"error"});return}return v(),p(`任务: ${x.name} 修改成功${o.msg}`,{autoHideDuration:3e3,variant:"success"}),!0},[x]),Te=m.useCallback(async()=>{if(x.type==="cron"&&!x.spec){p("选中cron类型, cron表达式不能为空！",{autoHideDuration:3e3,variant:"warning"});return}if(!x.name){p("job名称不能为空！",{autoHideDuration:3e3,variant:"warning"});return}const o=await Ge({name:x.name,type:"cron",spec:x.spec,cmd:x.cmd,cmd_type:x.cmd_type,cmd_id:x.cmd_id,execute_type:x.execute_type,execute_id:x.execute_id});if(o.code!=="200"){p(`添加任务失败${o.msg}`,{autoHideDuration:3e3,variant:"error"});return}return v(),p(`任务：${o.data.name} 添加成功${o.msg}`,{autoHideDuration:3e3,variant:"success"}),R({id:0,name:"",type:"task",spec:"",cmd:"",status:"",cmd_type:"cmd",cmd_id:0,execute_type:"host",execute_id:0}),!0},[x]),Me=()=>{d({type:"title",payload:"添加任务"}),d({type:"todo",payload:!0}),d({type:"open"})},Ie=o=>o==null?void 0:o.map(g=>{var P,$,ne;return{...g,executeName:($=(P=z[g.execute_type])==null?void 0:P.find(U=>U.id===g.execute_id))==null?void 0:$.name,cmd:g.cmd_type==="cmd"?g.cmd:(ne=s.find(U=>U.id===g.cmd_id))==null?void 0:ne.name}}),Oe=[{field:"id",headerName:"id",maxWidth:40},{field:"type",headerName:"任务类型",maxWidth:140},{field:"name",headerName:"任务名称",minWidth:140},{field:"execute_type",headerName:"执行对象类型",maxWidth:140},{field:"executeName",headerName:"执行对象",maxWidth:140},{field:"cmd_type",headerName:"命令类型",maxWidth:140},{field:"cmd",headerName:"命令/剧本名",maxWidth:140},{field:"status",headerName:"状态",maxWidth:140},{field:"spec",headerName:"cron表达式",maxWidth:140},{field:"action",headerName:"操作",minWidth:240,type:"actions",getActions:o=>{const{id:g,name:P}=o.row;return[a.jsx(M,{icon:a.jsx(O,{title:"执行一次任务",placement:"top-start",children:a.jsx(Pe,{onClick:()=>{re(o.row)},color:"primary"})}),label:"启动"},o.row.id+"执行一次任务"),a.jsx(M,{icon:a.jsx(O,{title:"启动",placement:"top-start",children:a.jsx(Z,{onClick:()=>{q(o.row)},color:"primary"})}),label:"启动"},o.row.id+"启动"),a.jsx(M,{icon:a.jsx(O,{title:"停止",placement:"top-start",children:a.jsx(Z,{onClick:()=>{Re(o.row)},color:"error"})}),label:"停止"},o.row.id+"停止"),a.jsx(M,{icon:a.jsx(O,{title:"查看日志列表",placement:"top-start",children:a.jsx(K,{onClick:()=>{Ne(o.row)}})}),label:"查看日志列表"},o.row.id+"查看日志列表"),a.jsx(M,{icon:a.jsx(O,{title:"编辑",placement:"top-start",children:a.jsx(ct,{color:"secondary",onClick:()=>{d({type:"todo",payload:!1}),d({type:"title",payload:"编辑任务信息"}),R(o.row),d({type:"open"})}})}),label:"编辑"},o.row.id+"Edit"),a.jsx(M,{icon:a.jsx(O,{title:"删除",placement:"top-start",children:a.jsx(dt,{color:"error",onClick:()=>{u({type:"open"}),u({type:"text",payload:`确认要删除任务：${P} 吗？`}),u({type:"title",payload:"删除任务"}),u({type:"todo",payload:()=>{De(o.row)}})}})}),label:"删除"},o.row.id+"Delete")]}}],Se=[{field:"id",headerName:"id",minWidth:40},{field:"job_id",headerName:"任务id",maxWidth:140},{field:"start_time",headerName:"开始时间",minWidth:240,valueGetter:o=>new Date(o.row.start_time).toLocaleString("chinese",{hour12:!1})},{field:"end_time",headerName:"结束时间",minWidth:240,valueGetter:o=>new Date(o.row.end_time).toLocaleString("chinese",{hour12:!1})},{field:"status",headerName:"执行状态",maxWidth:140},{field:"action",headerName:"操作",minWidth:240,type:"actions",getActions:o=>{const{id:g}=o.row;return[a.jsx(M,{icon:a.jsx(O,{title:"查看日志",placement:"top-start",children:a.jsx(K,{onClick:()=>{ke(g)}})}),label:"查看日志"},o.row.id+"查看日志")]}}];return a.jsxs("div",{className:C.itemPage,ref:f,style:{overflowY:"scroll"},children:[a.jsx("div",{className:C.ControlBox,children:a.jsx($e,{className:C.addButton,onClick:Me,children:"添加任务"})}),a.jsx("div",{className:C.shellBox,children:a.jsx(pe,{style:{width:"100%",height:"100%",margin:"0 auto",marginTop:"20px"},children:a.jsx(st,{columns:Oe,rows:Ie(i)})})}),k?a.jsx("div",{style:{width:"100%",height:"100%",margin:"0 auto",marginTop:"40px"},children:a.jsx(pe,{style:{width:"100%",height:"100%",margin:"0 auto",marginTop:"20px"},children:a.jsx(la,{getDataApi:Ve,dataId:k,columns:Se})})}):null,a.jsx(ea,{open:L,title:"任务日志",text:_,toClose:ze}),a.jsx(nt,{open:c.open,text:c.text,title:c.title,toClose:()=>u({type:"close"}),todo:c.todo}),a.jsx(lt,{open:y.open,content:J,toClose:()=>d({type:"close"}),title:y.title,todo:y.todo?Te:Be})]})},Aa=He(ca,da)(ga);export{Aa as default};
