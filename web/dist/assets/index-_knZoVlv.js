import{s as h,j as e,A as R,z as j,m as B,D as Q,r as l,aq as D,ar as $,T as z,as as A}from"./index-vyLcd-Je.js";import{b as k,O as T,a as L,G as y}from"./index-BvM0tQE_.js";import{O as w,d as I,a as E}from"./index-w5AVGF4v.js";import{T as H,F as N}from"./FormDialog-4Nls6tjn.js";import{B as W}from"./Modal-WZGSkPqe.js";import{C as V}from"./Card-YvtJUMab.js";import{T as x}from"./Tooltip-BizDiQoP.js";import"./Portal-fdJRnxBE.js";import"./ButtonBase-JuvOKhC4.js";import"./useIsFocusVisible-4p8xcV5K.js";import"./index-gPguApf8.js";import"./createSvgIcon-Wj1pg0ep.js";import"./useControlled-AZyJHjwc.js";import"./TextField-WpV9j2Nf.js";import"./Tooltip-uuOg3L5G.js";import"./KeyboardArrowRight-b8CMt5WL.js";import"./createSvgIcon-REPnXX8o.js";import"./DialogActions-TfqgKDOq.js";import"./Grow-AEneWTZ1.js";import"./useTheme-gj9g8ZO4.js";import"./Button-P3xriBeC.js";const O=t=>({root:{flexGrow:1,display:"flex",height:"100%",width:"100%",indicator:{"& > span":{maxWidth:40,width:"100%",backgroundColor:"#4bce21"}}},itemPage:{width:"100%",height:"100%"},ControlBox:{marginBottom:"20px",width:"100%"},Button:{marginRight:"20px"},Control:{width:"15%"},shellBox:{width:"100%",height:"90%"},TabPanel:{height:"100%",width:"100%"},tabs:{width:"240px",borderRight:`1px solid ${t.palette.divider}`},rootTable:{width:"100%",height:"100%"},container:{height:"92%"},deleteButton:{marginRight:"14px",backgroundColor:t.palette.error[t.palette.type],"&:hover":{backgroundColor:t.palette.error.main}},editBtn:{marginRight:"14px",backgroundColor:t.palette.warning[t.palette.type],"&:hover":{backgroundColor:t.palette.warning.main}},starBtn:{marginRight:"14px",backgroundColor:t.palette.primary[t.palette.type],"&:hover":{backgroundColor:t.palette.primary.main}},reStarBtn:{marginRight:"14px",backgroundColor:t.palette.info[t.palette.type],"&:hover":{backgroundColor:t.palette.info.main}},stopBtn:{marginRight:"14px",backgroundColor:t.palette.secondary[t.palette.type],"&:hover":{backgroundColor:t.palette.secondary.main}},addButton:{backgroundColor:t.palette.success[t.palette.type],"&:hover":{backgroundColor:t.palette.success.main}}});h(k)(({theme:t})=>({width:62,height:34,padding:7,"& .MuiSwitch-switchBase":{margin:1,padding:0,transform:"translateX(6px)","&.Mui-checked":{color:"#fff",transform:"translateX(22px)","& .MuiSwitch-thumb:before":{backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 20 20"><path fill="${encodeURIComponent("#fff")}" d="M4.2 2.5l-.7 1.8-1.8.7 1.8.7.7 1.8.6-1.8L6.7 5l-1.9-.7-.6-1.8zm15 8.3a6.7 6.7 0 11-6.6-6.6 5.8 5.8 0 006.6 6.6z"/></svg>')`},"& + .MuiSwitch-track":{opacity:1,backgroundColor:t.palette.mode==="dark"?"#8796A5":"#aab4be"}}},"& .MuiSwitch-thumb":{backgroundColor:t.palette.mode==="dark"?"#003892":"#001e3c",width:32,height:32,"&:before":{content:"''",position:"absolute",width:"100%",height:"100%",left:0,top:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 20 20"><path fill="${encodeURIComponent("#fff")}" d="M9.305 1.667V3.75h1.389V1.667h-1.39zm-4.707 1.95l-.982.982L5.09 6.072l.982-.982-1.473-1.473zm10.802 0L13.927 5.09l.982.982 1.473-1.473-.982-.982zM10 5.139a4.872 4.872 0 00-4.862 4.86A4.872 4.872 0 0010 14.862 4.872 4.872 0 0014.86 10 4.872 4.872 0 0010 5.139zm0 1.389A3.462 3.462 0 0113.471 10a3.462 3.462 0 01-3.473 3.472A3.462 3.462 0 016.527 10 3.462 3.462 0 0110 6.528zM1.665 9.305v1.39h2.083v-1.39H1.666zm14.583 0v1.39h2.084v-1.39h-2.084zM5.09 13.928L3.616 15.4l.982.982 1.473-1.473-.982-.982zm9.82 0l-.982.982 1.473 1.473.982-.982-1.473-1.473zM9.305 16.25v2.083h1.389V16.25h-1.39z"/></svg>')`}},"& .MuiSwitch-track":{opacity:1,backgroundColor:t.palette.mode==="dark"?"#8796A5":"#aab4be",borderRadius:20/2}}));h(k)(({theme:t})=>({padding:8,"& .MuiSwitch-track":{borderRadius:22/2,"&:before, &:after":{content:'""',position:"absolute",top:"50%",transform:"translateY(-50%)",width:16,height:16},"&:before":{backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 24 24"><path fill="${encodeURIComponent(t.palette.getContrastText(t.palette.primary.main))}" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg>')`,left:12},"&:after":{backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 24 24"><path fill="${encodeURIComponent(t.palette.getContrastText(t.palette.primary.main))}" d="M19,13H5V11H19V13Z" /></svg>')`,right:12}},"& .MuiSwitch-thumb":{boxShadow:"none",width:16,height:16,margin:2}}));const F=h(t=>e.jsx(k,{focusVisibleClassName:".Mui-focusVisible",disableRipple:!0,...t}))(({theme:t})=>({width:42,height:26,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(16px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:t.palette.mode==="dark"?"#2ECA45":"#65C466",opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:"#33cf4d",border:"6px solid #fff"},"&.Mui-disabled .MuiSwitch-thumb":{color:t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[600]},"&.Mui-disabled + .MuiSwitch-track":{opacity:t.palette.mode==="light"?.7:.3}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:22,height:22},"& .MuiSwitch-track":{borderRadius:26/2,backgroundColor:t.palette.mode==="light"?"#E9E9EA":"#39393D",opacity:1,transition:t.transitions.create(["background-color"],{duration:500})}}));function u(){return{open:!1,title:"",isAdd:!1,quickCommand_id:0,quickCommand_name:"",quickCommand_cmd:"",quickCommand_append_cr:!1}}function P(t,o){switch(o.type){case"open":return{...t,open:!0};case"close":return{...t,open:!1};case"title":return{...t,title:o.payload};case"isAdd":return{...t,isAdd:o.payload};case"setQuickCommand_id":return{...t,quickCommand_id:o.payload};case"setQuickCommand_name":return{...t,quickCommand_name:o.payload};case"setQuickCommand_cmd":return{...t,quickCommand_cmd:o.payload};case"setQuickCommand_append_cr":return{...t,quickCommand_append_cr:o.payload};case"reset":return u();default:throw new Error}}function g(){return{open:!1,text:"",title:"",todo:!0}}function G(t,o){switch(o.type){case"open":return{...t,open:!0};case"close":return{...t,open:!1};case"text":return{...t,text:o.payload};case"title":return{...t,title:o.payload};case"todo":return{...t,todo:o.payload};case"reset":return g();default:throw new Error}}const U=(t,o)=>({...o,quickCommandList:t.quickCommandList}),X={initQuickCommandAction:j.initQuickCommandList},Z=t=>{const{initQuickCommandAction:o,quickCommandList:b}=t,p=B(O)(),{enqueueSnackbar:d}=Q(),[i,r]=l.useReducer(P,u(),u),[s,c]=l.useReducer(G,g(),g);l.useEffect(()=>{o()},[o]);const C=async a=>{r({type:"isAdd",payload:a}),r({type:"title",payload:a?"添加快捷命令":"编辑快捷命令"}),r({type:"open"})},v=l.useCallback(async()=>{try{if(!i.quickCommand_name||!i.quickCommand_cmd){d("快捷命令名称和步骤名称不能为空",{autoHideDuration:5e3,variant:"warning"});return}const a={name:i.quickCommand_name,cmd:i.quickCommand_cmd,append_cr:i.quickCommand_append_cr};if(i.isAdd){const n=await D(a);n.code==="200"?(d(`快捷命令 ${a.name}添加成功！`,{autoHideDuration:5e3,variant:"success"}),r({type:"reset"}),o()):d(`快捷命令 ${a.name}添加失败！${n.msg}`,{autoHideDuration:5e3,variant:"error"})}else{const n=await $({id:i.quickCommand_id,...a});n.code==="200"?(d(`快捷命令 ${a.name}修改成功！`,{autoHideDuration:5e3,variant:"success"}),r({type:"reset"}),o()):(d(`快捷命令 ${a.name}修改失败！${n.msg}`,{autoHideDuration:5e3,variant:"error"}),r({type:"reset"}))}}catch(a){d(`'快捷命令操作ERR: ${JSON.stringify(a)}`,{autoHideDuration:5e3,variant:"error"})}return!0},[i.quickCommand_name,i.quickCommand_cmd,i.quickCommand_append_cr,i.quickCommand_id]),_=e.jsxs(e.Fragment,{children:[e.jsx(w,{margin:"dense",id:"quickCommand_name",label:"快捷命令名称",fullWidth:!0,value:i.quickCommand_name,onChange:a=>r({type:"setQuickCommand_name",payload:a.target.value})}),e.jsx(w,{margin:"dense",id:"quickCommand_cmd",label:"cmd",fullWidth:!0,value:i.quickCommand_cmd,onChange:a=>r({type:"setQuickCommand_cmd",payload:a.target.value})}),e.jsxs(L,{style:{marginTop:"4px"},direction:"row",spacing:1,alignItems:"center",children:[e.jsx(z,{children:"是否追加CR:"}),e.jsx(F,{checked:i.quickCommand_append_cr,onChange:a=>r({type:"setQuickCommand_append_cr",payload:a.target.checked})})]})]}),M=[{field:"id",headerName:"id",minWidth:80},{field:"name",headerName:"命令名称",minWidth:240},{field:"cmd",headerName:"命令内容",minWidth:240},{field:"append_cr",headerName:"是否追加CR",minWidth:240,valueGetter:a=>a.row.append_cr?"是":"否"},{field:"action",headerName:"操作",minWidth:240,type:"actions",getActions:a=>{const{id:n,name:m,cmd:q,append_cr:S}=a.row;return[e.jsx(y,{icon:e.jsx(x,{title:"编辑",placement:"top-start",children:e.jsx(I,{color:"secondary",fontSize:"medium",onClick:()=>{r({type:"setQuickCommand_id",payload:n}),r({type:"setQuickCommand_name",payload:m}),r({type:"setQuickCommand_cmd",payload:q}),r({type:"setQuickCommand_append_cr",payload:S}),C(!1)}})}),label:"编辑"},n+"playbook_Edit"),e.jsx(y,{icon:e.jsx(x,{title:"删除",placement:"top-start",children:e.jsx(E,{color:"error",fontSize:"medium",onClick:()=>{c({type:"title",payload:"删除快捷命令"}),c({type:"text",payload:`确认要删除${m}吗? id: ${n}`}),c({type:"todo",payload:async()=>{const f=await A(n);f.code==="200"?(d(`'快捷命令: ${m}删除成功！`,{autoHideDuration:5e3,variant:"success"}),o()):d(`'快捷命令: ${m}删除失败！ ${f.msg}`,{autoHideDuration:5e3,variant:"error"})}}),c({type:"open"})}})}),label:"删除"},n+"QuickCommand-Delete")]}}];return e.jsxs("div",{className:p.itemPage,children:[e.jsx("div",{className:p.ControlBox,children:e.jsx(W,{variant:"contained",style:{marginRight:"20px"},onClick:()=>C(!0),children:"添加快捷命令"})}),e.jsx("div",{className:p.shellBox,children:e.jsx(V,{style:{width:"100%",height:"100%",margin:"0 auto",marginTop:"20px"},children:e.jsx(T,{columns:M,rows:b})})}),e.jsx(H,{open:s.open,text:s.text,title:s.title,toClose:()=>c({type:"close"}),todo:s.todo}),e.jsx(N,{maxWidth:"md",open:i.open,content:_,toClose:()=>{r({type:"close"}),r({type:"reset"})},title:i.title,todo:v})]})},yt=R(U,X)(Z);export{yt as default};
