var Te=Object.defineProperty;var Re=(b,t,c)=>t in b?Te(b,t,{enumerable:!0,configurable:!0,writable:!0,value:c}):b[t]=c;var K=(b,t,c)=>(Re(b,typeof t!="symbol"?t+"":t,c),c);import{ag as De,b5 as Le,D as ue,r as F,j as C,A as Fe,z as _e,m as je,R as He,V as Me,I as Be,y as ze,b6 as Pe}from"./index-vyLcd-Je.js";import{d as Ue}from"./Link-R1uTwV-6.js";import{d as Xe}from"./LinkOff-74wAO7T2.js";import{d as Ge}from"./Send-u5HxT_Xo.js";import{O as ce,a as de,S as le}from"./OmsMenuItem-dCh26iEY.js";import{x as Ke,a as Ve}from"./xterm-addon-fit-Kh6Ly0p6.js";import{U as We}from"./UploadButton-yzcrOpeE.js";import{D as $e,a as qe,b as Qe,c as Ye}from"./DialogActions-TfqgKDOq.js";import{B as V}from"./Button-P3xriBeC.js";import{O as Je}from"./index-28OOwwxE.js";import{b as et}from"./url-3gxhyDQ6.js";import{C as tt,a as rt,d as nt,b as st}from"./ChromeTabPanel-o1rZlIZt.js";import{d as it}from"./Add-XMANssNT.js";import{T as he}from"./Tooltip-BizDiQoP.js";import{b as fe}from"./Select-SR092O4V.js";import"./ExpandMore-3kkaHWRN.js";import"./MenuItem-XkAApCKL.js";import"./SnackMessageUpLoadFileProgress-mrKZ2kvA.js";import"./LinearProgress-L2jHxBZR.js";import"./useTheme-gj9g8ZO4.js";import"./Box-C_Unawo1.js";import"./Card-ZBbaDw8s.js";import"./Grow-AEneWTZ1.js";import"./TextField-ExYO2cNO.js";import"./Tab-Gl8EGwko.js";import"./KeyboardArrowRight-okvb3hby.js";import"./createSvgIcon-REPnXX8o.js";import"./createSvgIcon-Wj1pg0ep.js";import"./useControlled-AZyJHjwc.js";import"./useIsFocusVisible-4p8xcV5K.js";var pe={exports:{}},me={exports:{}},be={exports:{}};(function(b){var t=b.exports;const c=24,h=17,I=19,a=128|h,r=128|I,n=24;t.ZMLIB={ZDLE:c,XON:h,XOFF:I,ABORT_SEQUENCE:[n,n,n,n,n],strip_ignored_bytes:function(p){for(var y=p.length-1;y>=0;y--)switch(p[y]){case h:case a:case I:case r:p.splice(y,1);continue}return p},find_subarray:function(p,y){var v=0,m;e:for(;v!==-1;){if(v=p.indexOf(y[0],v),v===-1)break e;for(m=1;m<y.length;m++)if(p[v+m]!==y[m]){v++;continue e}return v}return-1}}})(be);var X=be.exports,ge={exports:{}},ve={exports:{}};(function(b){var t=b.exports;const c=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102],h={};for(var I=0;I<c.length;I++)h[c[I]]=I;t.ENCODELIB={pack_u16_be:function(r){if(r>65535)throw"Number cannot exceed 16 bits: "+r;return[r>>8,r&255]},pack_u32_le:function(r){var n=r/65536;return[r&255,(r&65535)>>8,n&255,n>>8]},unpack_u16_be:function(r){return(r[0]<<8)+r[1]},unpack_u32_le:function(r){return r[0]+(r[1]<<8)+(r[2]<<16)+r[3]*16777216},octets_to_hex:function(r){for(var n=[],_=0;_<r.length;_++)n.push(c[r[_]>>4],c[r[_]&15]);return n},parse_hex_octets:function(r){for(var n=new Array(r.length/2),_=0;_<n.length;_++)n[_]=(h[r[2*_]]<<4)+h[r[1+2*_]];return n}}})(ve);var J=ve.exports,xe={exports:{}};(function(b){class t{encode(a){a=unescape(encodeURIComponent(a));for(var r=new Array(a.length),n=0;n<a.length;n++)r[n]=a.charCodeAt(n);return new Uint8Array(r)}}class c{decode(a){return decodeURIComponent(escape(String.fromCharCode.apply(String,a)))}}var h=b.exports;h.Text={Encoder:typeof TextEncoder<"u"?TextEncoder:t,Decoder:typeof TextDecoder<"u"?TextDecoder:c}})(xe);var at=xe.exports,Ee={exports:{}};(function(b){var t=b.exports;Object.assign(t,X);var c,h;const I=t.ZMLIB.ZDLE;t.ZDLE=class ye{constructor(r){this._config={},r&&this.set_escape_ctrl_chars(!!r.escape_ctrl_chars)}set_escape_ctrl_chars(r){if(typeof r!="boolean")throw"need boolean!";r!==this._config.escape_ctrl_chars&&(this._config.escape_ctrl_chars=r,this._setup_zdle_table())}escapes_ctrl_chars(){return!!this._config.escape_ctrl_chars}encode(r){if(!this._zdle_table)throw"No ZDLE encode table configured!";var n=this._zdle_table,_=this._lastcode,p=new ArrayBuffer(2*r.length),y=new Uint8Array(p),v=this._config.escape_ctrl_chars,m=0;for(c=0;c<r.length;c++){if(h=n[r[c]],!h)throw console.trace(),console.error("bad encode() call:",JSON.stringify(r)),this._lastcode=_,"Invalid octet: "+r[c];_=r[c],h===1||(v||h===2||(_&127)===64)&&(y[m]=I,m++,_^=64),y[m]=_,m++}return this._lastcode=_,r.splice(0),r.push.apply(r,new Uint8Array(p,0,m)),r}static decode(r){for(var n=r.length-1;n>=0;n--)r[n]===I&&r.splice(n,2,r[n+1]-64);return r}static splice(r,n,_){var p=0;n||(n=0);for(var y=n;y<r.length&&p<_;y++)p++,r[y]===I&&y++;if(p===_)return r.length===y-1?void 0:(r.splice(0,n),ye.decode(r.splice(0,y-n)))}_setup_zdle_table(){for(var r=new Array(256),n=0;n<r.length;n++)if(n&96)r[n]=1;else switch(n){case I:case t.ZMLIB.XOFF:case t.ZMLIB.XON:case t.ZMLIB.XOFF|128:case t.ZMLIB.XON|128:r[n]=2;break;case 16:case 144:r[n]=this._config.turbo_escape?1:2;break;case 13:case 141:r[n]=this._config.escape_ctrl_chars?2:this._config.turbo_escape?1:3;break;default:r[n]=this._config.escape_ctrl_chars?2:1}this._zdle_table=r}}})(Ee);var ee=Ee.exports,Ie={exports:{}},Ze={exports:{}},we={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */(function(b){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?b:{})})(function(t){t.version="1.2.2";function c(){for(var s=0,k=new Array(256),l=0;l!=256;++l)s=l,s=s&1?-306674912^s>>>1:s>>>1,s=s&1?-306674912^s>>>1:s>>>1,s=s&1?-306674912^s>>>1:s>>>1,s=s&1?-306674912^s>>>1:s>>>1,s=s&1?-306674912^s>>>1:s>>>1,s=s&1?-306674912^s>>>1:s>>>1,s=s&1?-306674912^s>>>1:s>>>1,s=s&1?-306674912^s>>>1:s>>>1,k[l]=s;return typeof Int32Array<"u"?new Int32Array(k):k}var h=c();function I(s){var k=0,l=0,A=0,x=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(A=0;A!=256;++A)x[A]=s[A];for(A=0;A!=256;++A)for(l=s[A],k=256+A;k<4096;k+=256)l=x[k]=l>>>8^s[l&255];var T=[];for(A=1;A!=16;++A)T[A-1]=typeof Int32Array<"u"?x.subarray(A*256,A*256+256):x.slice(A*256,A*256+256);return T}var a=I(h),r=a[0],n=a[1],_=a[2],p=a[3],y=a[4],v=a[5],m=a[6],N=a[7],u=a[8],f=a[9],e=a[10],i=a[11],o=a[12],g=a[13],S=a[14];function w(s,k){for(var l=k^-1,A=0,x=s.length;A<x;)l=l>>>8^h[(l^s.charCodeAt(A++))&255];return~l}function R(s,k){for(var l=k^-1,A=s.length-15,x=0;x<A;)l=S[s[x++]^l&255]^g[s[x++]^l>>8&255]^o[s[x++]^l>>16&255]^i[s[x++]^l>>>24]^e[s[x++]]^f[s[x++]]^u[s[x++]]^N[s[x++]]^m[s[x++]]^v[s[x++]]^y[s[x++]]^p[s[x++]]^_[s[x++]]^n[s[x++]]^r[s[x++]]^h[s[x++]];for(A+=15;x<A;)l=l>>>8^h[(l^s[x++])&255];return~l}function L(s,k){for(var l=k^-1,A=0,x=s.length,T=0,z=0;A<x;)T=s.charCodeAt(A++),T<128?l=l>>>8^h[(l^T)&255]:T<2048?(l=l>>>8^h[(l^(192|T>>6&31))&255],l=l>>>8^h[(l^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,z=s.charCodeAt(A++)&1023,l=l>>>8^h[(l^(240|T>>8&7))&255],l=l>>>8^h[(l^(128|T>>2&63))&255],l=l>>>8^h[(l^(128|z>>6&15|(T&3)<<4))&255],l=l>>>8^h[(l^(128|z&63))&255]):(l=l>>>8^h[(l^(224|T>>12&15))&255],l=l>>>8^h[(l^(128|T>>6&63))&255],l=l>>>8^h[(l^(128|T&63))&255]);return~l}t.table=h,t.bstr=w,t.buf=R,t.str=L})})(we);var Ae={exports:{}};(function(b){var t=b.exports;function c(r,n){return this.got=r.slice(0),this.expected=n.slice(0),"CRC check failed! (got: "+r.join()+"; expected: "+n.join()+")"}function h(r){return r}const I={aborted:"Session aborted",peer_aborted:"Peer aborted session",already_aborted:"Session already aborted",crc:c,validation:h};function a(r){const n=I[r];switch(typeof n){case"string":return n;case"function":var _=[].slice.call(arguments).slice(1);return n.apply(this,_)}return null}t.Error=class extends Error{constructor(n){super();var _=a.apply(this,arguments);_?(this.type=n,this.message=_):this.message=n}}})(Ae);var G=Ae.exports;(function(b){const t=we;var c=b.exports;Object.assign(c,G,J);var h;const I=16,a=4129,r=65535,n=1<<I-1;function _(){h=new Array(256);for(var v=I-8,m=0;m<256;m++){for(var N=m<<v&r,u=0;u<8;u++)N&n?(N<<=1,N^=a):N<<=1;h[m]=N&r}}function p(v,m){return h||_(),h[m>>8&255]^(255&m)<<8^v}function y(v,m){if(v.join()!==m.join())throw new c.Error("crc",m,v)}c.CRC={crc16:function(m){for(var N=m[0],u=1;u<m.length;u++)N=p(m[u],N);return N=p(0,p(0,N)),c.ENCODELIB.pack_u16_be(N)},crc32:function(m){return c.ENCODELIB.pack_u32_le(t.buf(m)>>>0)},verify16:function(m,N){return y(this.crc16(m),N)},verify32:function(m,N){try{y(this.crc32(m),N)}catch(u){throw u.input=m.slice(0),u}}}})(Ze);var Ce=Ze.exports;(function(b){var t=b.exports;Object.assign(t,J,ee,X,Ce,G);const c=42,h=65,I=66,a=67,r=[13,10],n=r.slice(0).concat([t.ZMLIB.XON]),_=[c,c,t.ZMLIB.ZDLE,I],p=[c,t.ZMLIB.ZDLE,h],y=[c,t.ZMLIB.ZDLE,a];t.Header=class{static trim_leading_garbage(d){var E=[],O,D;e:for(;d.length&&!D;){var j=d.indexOf(c);if(j===-1){O=!0;break e}else{if(E.push.apply(E,d.splice(0,j)),d.length<2)break e;if(d[1]===c)if(d.length<_.length){if(d.join()===_.slice(0,d.length).join())break e}else d[2]===_[2]&&d[3]===_[3]&&(D=W);else if(d[1]===t.ZMLIB.ZDLE){if(d.length<p.length)break e;d[2]===p[2]?D=ie:d[2]===y[2]&&(D=oe)}D||E.push(d.shift())}}return O&&E.push.apply(E,d.splice(0)),E}static parse(d){var E;if(d[1]===c)return E=W(d),E&&[E,16];if(d[2]===h)return E=ie(d),E&&[E,16];if(d[2]===a)return E=oe(d),E&&[E,32];if(!(d.length<3))throw"Unrecognized/unsupported octets: "+d.join()}static build(d){var E=arguments.length===1?[arguments[0]]:Array.apply(null,arguments),O=ne[d];if(!O)throw"No frame class “"+d+"” is defined!";E.shift();var D=new(O.bind.apply(O,[null].concat(E)));return D}to_hex(){var d=this._crc_bytes();return _.concat(t.ENCODELIB.octets_to_hex(d.concat(t.CRC.crc16(d))),this._hex_header_ending)}to_binary16(d){return this._to_binary(d,p,t.CRC.crc16)}to_binary32(d){return this._to_binary(d,y,t.CRC.crc32)}constructor(){this._bytes4||(this._bytes4=[0,0,0,0])}_to_binary(d,E,O){var D=this._crc_bytes(),j=E.concat(d.encode(D.concat(O(D))));return j}_crc_bytes(){return[this.TYPENUM].concat(this._bytes4)}},t.Header.prototype._hex_header_ending=n;class v extends t.Header{}const m={CANFDX:1,CANOVIO:2,CANBRK:4,CANCRY:8,CANLZW:16,CANFC32:32,ESCCTL:64,ESC8:128};function N(Z){if(!m[Z])throw new t.Error("Invalid ZRINIT flag: "+Z);return m[Z]}class u extends t.Header{constructor(d,E){super();var O=0;E||(E=0),d.forEach(function(D){O|=N(D)}),this._bytes4=[E&255,E>>8,0,O]}get_buffer_size(){return t.ENCODELIB.unpack_u16_be(this._bytes4.slice(0,2))||void 0}can_full_duplex(){return!!(this._bytes4[3]&m.CANFDX)}can_overlap_io(){return!!(this._bytes4[3]&m.CANOVIO)}can_break(){return!!(this._bytes4[3]&m.CANBRK)}can_fcs_32(){return!!(this._bytes4[3]&m.CANFC32)}escape_ctrl_chars(){return!!(this._bytes4[3]&m.ESCCTL)}escape_8th_bit(){return!!(this._bytes4[3]&m.ESC8)}}const f={ESCCTL:64,ESC8:128};function e(Z){if(!f[Z])throw"Invalid ZSINIT flag: "+Z;return f[Z]}class i extends t.Header{constructor(d,E){super();var O=0;if(d.forEach(function(D){O|=e(D)}),this._bytes4=[0,0,0,O],E){if(E.length>31)throw"Attn sequence must be <= 31 bytes";if(E.some(function(D){return D>255}))throw"Attn sequence ("+E+") must be <256";this._data=E.concat([0])}}escape_ctrl_chars(){return!!(this._bytes4[3]&f.ESCCTL)}escape_8th_bit(){return!!(this._bytes4[3]&f.ESC8)}}class o extends t.Header{constructor(d){super(),d&&(this._bytes4=d.slice())}}o.prototype._hex_header_ending=r;const g={extended:{sparse:64},transport:[void 0,"compress","encrypt","rle"],management:[void 0,"newer_or_longer","crc","append","clobber","newer","mtime_or_length","protect","rename"],conversion:[void 0,"binary","text","resume"]},S=["extended","transport","management","conversion"],w=128,R=31,L=64;class s extends t.Header{get_options(){var d={sparse:!!(this._bytes4[0]&L)},E=this._bytes4.slice(0);return S.forEach(function(O,D){if(g[O]instanceof Array)O==="management"&&(d.skip_if_absent=!!(E[D]&w),E[D]&=R),d[O]=g[O][E[D]];else for(var j in g[O])d[j]=!!(E[D]&g[O][j]),d[j]&&(E[D]^=g[O][j]);!d[O]&&E[D]&&(d[O]="unknown:"+E[D])}),d}}class k extends t.Header{}class l extends t.Header{}class A extends t.Header{}class x extends t.Header{}A.prototype._hex_header_ending=r;class T extends t.Header{constructor(d){super(),this._bytes4=t.ENCODELIB.pack_u32_le(d)}get_offset(){return t.ENCODELIB.unpack_u32_le(this._bytes4)}}class z extends T{}class te extends T{}class re extends T{}const P=[[v,"ZRQINIT"],[u,"ZRINIT"],[i,"ZSINIT"],[o,"ZACK"],[s,"ZFILE"],[k,"ZSKIP"],void 0,[l,"ZABORT"],[A,"ZFIN"],[z,"ZRPOS"],[te,"ZDATA"],[re,"ZEOF"],[x,"ZFERR"],void 0,void 0,void 0,void 0,void 0,void 0,void 0];for(var ne={},M=0;M<P.length;M++)P[M]&&(ne[P[M][1]]=P[M][0],Object.assign(P[M][0].prototype,{TYPENUM:M,NAME:P[M][1]}));const Se=[v,u,i,o,s,k,"ZNAK",l,A,z,te,re,x,"ZCRC","ZCHALLENGE","ZCOMPL","ZCAN","ZFREECNT","ZCOMMAND","ZSTDERR"];function se(Z){var d=Se[Z];if(typeof d=="string")throw"Received unsupported header: "+d;return ke(d)}function ke(Z){return Z.prototype instanceof T?new Z(0):new Z([])}function ie(Z){var d=t.ZDLE.splice(Z,p.length,7);return d&&ae(d)}function ae(Z){t.CRC.verify16(Z.slice(0,5),Z.slice(5));var d=Z[0],E=se(d);return E._bytes4=Z.slice(1,5),E}function oe(Z){var d=t.ZDLE.splice(Z,y.length,9);if(d){t.CRC.verify32(d.slice(0,5),d.slice(5));var E=d[0],O=se(E);return O._bytes4=d.slice(1,5),O}}function W(Z){var d=Z.indexOf(138);d===-1&&(d=Z.indexOf(10));var E,O;if(d===-1){Z.length>11&&(E="Invalid hex header - no LF detected within 12 bytes!");return}else if(O=Z.splice(0,d),Z.shift(),O.length===19){var D=O.pop();D!==13&&D!==141&&(E="Invalid hex header: (CR/)LF doesn’t have CR!")}else O.length!==18&&(E="Invalid hex header: invalid number of bytes before LF!");if(E)throw E+=" ("+O.length+" bytes: "+O.join()+")",E;O.splice(0,4);var j=t.ENCODELIB.parse_hex_octets(O);return ae(j)}t.Header.parse_hex=W})(Ie);var ot=Ie.exports,Oe={exports:{}};(function(b){var t=b.exports;Object.assign(t,Ce,ee,X,G);const c=104,h=105,I=106,a=107;var r;t.Subpacket=class Q{static build(u,f){var e=r[f];if(!e)throw"No subpacket type “"+f+"” is defined! Try one of: "+Object.keys(r).join(", ");return new e(u)}encode16(u){return this._encode(u,t.CRC.crc16)}encode32(u){return this._encode(u,t.CRC.crc32)}get_payload(){return this._payload}static parse16(u){return Q._parse(u,2)}static parse32(u){return Q._parse(u,4)}constructor(u){this._payload=u}_encode(u,f){return u.encode(this._payload.slice(0)).concat([t.ZMLIB.ZDLE,this._frameend_num],u.encode(f(this._payload.concat(this._frameend_num))))}static _parse(u,f){for(var e,i,o={104:p,105:v,106:m,107:y},g=0;g<u.length;){if(g=u.indexOf(t.ZMLIB.ZDLE,g),g===-1)return;var S=u[g+1];if(i=o[S],i){e=g+1;break}g++}if(i){var w=u[e];if(u[e-1]!==t.ZMLIB.ZDLE)throw"Byte before frame end should be ZDLE, not "+u[e-1];var R=u.splice(0,e-1),L=t.ZDLE.splice(u,2,f);if(!L){u.unshift.apply(u,R);return}var s=t.ZDLE.decode(R);return t.CRC[f===2?"verify16":"verify32"](s.concat([w]),L),new i(s,L)}}};class n extends t.Subpacket{frame_end(){return!0}}class _ extends t.Subpacket{frame_end(){return!1}}class p extends n{ack_expected(){return!1}}p.prototype._frameend_num=c;class y extends n{ack_expected(){return!0}}y.prototype._frameend_num=a;class v extends _{ack_expected(){return!1}}v.prototype._frameend_num=h;class m extends _{ack_expected(){return!0}}m.prototype._frameend_num=I,r={end_no_ack:p,end_ack:y,no_end_no_ack:v,no_end_ack:m}})(Oe);var _t=Oe.exports,Ne={exports:{}};(function(b){var t=b.exports;Object.assign(t,G);const c=/\*\x18[AC]|\*\*\x18B/;function h(I,a){if(a<0)throw new t.Error("validation","“"+I+"” ("+a+") must be nonnegative.");if(a!==Math.floor(a))throw new t.Error("validation","“"+I+"” ("+a+") must be an integer.")}t.Validation={offer_parameters:function(a){if(!a.name)throw new t.Error("validation","Need “name”!");if(typeof a.name!="string")throw new t.Error("validation","“name” ("+a.name+") must be a string!");if(a=Object.assign({},a),c.test(a.name)&&console.warn("The filename "+JSON.stringify(name)+" contains characters that look like a ZMODEM header. This could corrupt the ZMODEM session; consider renaming it so that the filename doesn’t contain control characters."),a.serial!==null&&a.serial!==void 0)throw new t.Error("validation","“serial” is meaningless.");if(a.serial=null,["size","mode","files_remaining","bytes_remaining"].forEach(function(_){var p;switch(typeof a[_]){case"object":p=a[_]===null;break;case"undefined":a[_]=null,p=!0;break;case"number":h(_,a[_]),p=!0;break}if(!p)throw new t.Error("validation","“"+_+"” ("+a[_]+") must be null, undefined, or a number.")}),typeof a.mode=="number"&&(a.mode|=32768),a.files_remaining===0)throw new t.Error("validation","“files_remaining”, if given, must be positive.");var r;switch(typeof a.mtime){case"object":if(r=!0,a.mtime instanceof Date){var n=a.mtime;if(a.mtime=Math.floor(n.getTime()/1e3),a.mtime<0)throw new t.Error("validation","“mtime” ("+n+") must not be earlier than 1970.")}else a.mtime!==null&&(r=!1);break;case"undefined":a.mtime=null,r=!0;break;case"number":h("mtime",a.mtime),r=!0;break}if(!r)throw new t.Error("validation","“mtime” ("+a.mtime+") must be null, undefined, a Date, or a number.");return a}}})(Ne);var ct=Ne.exports;(function(b){var t=b.exports;t.DEBUG=!1,Object.assign(t,J,at,ee,X,ot,_t,ct,G);const c=5e3,h=["CANFDX","CANOVIO","CANFC32"],I="spool_uint8array",a=8192,r=8,n=[79,79],_=t.ZMLIB.ABORT_SEQUENCE;class p{constructor(){this._on_evt={},this._evt_once_index={}}_Add_event(e){this._on_evt[e]=[],this._evt_once_index[e]=[]}_get_evt_queue(e){if(!this._on_evt[e])throw"Bad event: "+e;return this._on_evt[e]}on(e,i){var o=this._get_evt_queue(e);return o.push(i),this}off(e,i){var o=this._get_evt_queue(e);if(i){var g=o.indexOf(i);if(g===-1)throw"“"+i+"” is not in the “"+e+"” queue.";o.splice(g,1)}else o.pop();return this}_Happen(e){var i=this._get_evt_queue(e),o=Array.apply(null,arguments);o.shift();var g=this;return i.forEach(function(S){S.apply(g,o)}),i.length}}t.Session=class extends p{static parse(e){var i;try{i=t.Header.parse_hex(e)}catch{return}if(i)switch(i.NAME){case"ZRQINIT":return new t.Session.Receive;case"ZRINIT":return new t.Session.Send(i)}}set_sender(e){return this._sender=e,this}has_ended(){return this._has_ended()}consume(e){if(this._before_consume(e),this._aborted)throw new t.Error("already_aborted");e.length&&(this._strip_and_enqueue_input(e),this._check_for_abort_sequence(e)||this._consume_first())}aborted(){return!!this._aborted}constructor(){super(),this._config={},this._input_buffer=[],this._Add_event("receive"),this._Add_event("garbage"),this._Add_event("session_end")}get_role(){return this.type}_trim_leading_garbage_until_header(){var e=t.Header.trim_leading_garbage(this._input_buffer);e.length&&this._Happen("garbage",e)===0&&console.debug("Garbage: ",String.fromCharCode.apply(String,e),e)}_parse_and_consume_header(){this._trim_leading_garbage_until_header();var e=t.Header.parse(this._input_buffer);if(e)return t.DEBUG&&this._log_header("RECEIVED HEADER",e[0]),this._consume_header(e[0]),this._last_header_name=e[0].NAME,this._last_header_crc=e[1],e[0]}_log_header(e,i){console.debug(this.type,e,i.NAME,i._bytes4.join())}_consume_header(e){this._on_receive(e);var i=this._next_header_handler&&this._next_header_handler[e.NAME];if(!i)throw console.error("Unhandled header!",e,this._next_header_handler),new t.Error("Unhandled header: "+e.NAME);this._next_header_handler=null,i.call(this,e)}_check_for_abort_sequence(){var e=t.ZMLIB.find_subarray(this._input_buffer,_);if(e!==-1)throw this._input_buffer.splice(0,e+_.length),this._aborted=!0,this._on_session_end(),new t.Error("peer_aborted")}_send_header(e){if(!this._sender)throw"Need sender!";var i=Array.apply(null,arguments),o=this._create_header_bytes(i);t.DEBUG&&this._log_header("SENDING HEADER",o[1]),this._sender(o[0]),this._last_sent_header=o[1]}_create_header_bytes(e){var i=t.Header.build.apply(t.Header,e),o=this._get_header_formatter(e[0]);return[i[o](this._zencoder),i]}_strip_and_enqueue_input(e){t.ZMLIB.strip_ignored_bytes(e),this._input_buffer.push.apply(this._input_buffer,e)}abort(){this._sender(_.concat([r,r,r,r,r])),this._aborted=!0,this._sender=function(){throw new t.Error("already_aborted")},this._on_session_end()}_on_session_end(){this._Happen("session_end")}_on_receive(e){this._Happen("receive",e)}_before_consume(){}};function y(f){return t.ZMLIB.find_subarray(f,n)===0?f.splice(0,n.length):f[0]===n[n.length-1]&&f.splice(0,1),f}t.Session.Receive=class extends t.Session{constructor(){super(),this._Add_event("offer"),this._Add_event("data_in"),this._Add_event("file_end")}_before_consume(e){if(this._bytes_after_OO)throw"PROTOCOL: Session is completed!";this._bytes_being_consumed=e}get_trailing_bytes(){if(this._aborted)return[];if(!this._bytes_after_OO)throw"PROTOCOL: Session is not completed!";return this._bytes_after_OO.slice(0)}_has_ended(){return this.aborted()||!!this._bytes_after_OO}_get_header_formatter(){return"to_hex"}_parse_and_consume_subpacket(){var e;this._last_header_crc===16?e="parse16":e="parse32";var i=t.Subpacket[e](this._input_buffer);return i&&(t.DEBUG&&console.debug(this.type,"RECEIVED SUBPACKET",i),this._consume_data(i),i.frame_end()&&(this._next_subpacket_handler=null)),i}_consume_first(){if(this._got_ZFIN){if(this._input_buffer.length<2)return;if(t.ZMLIB.find_subarray(this._input_buffer,n)===0){this._bytes_after_OO=y(this._bytes_being_consumed.slice(0)),this._on_session_end();return}else throw"PROTOCOL: Only thing after ZFIN should be “OO” (79,79), not: "+this._input_buffer.join()}var e;do this._next_subpacket_handler?e=this._parse_and_consume_subpacket():e=this._parse_and_consume_header();while(e&&this._input_buffer.length)}_consume_data(e){if(this._on_receive(e),!this._next_subpacket_handler)throw"PROTOCOL: Received unexpected data packet after "+this._last_header_name+" header: "+e.get_payload().join();this._next_subpacket_handler.call(this,e)}_octets_to_string(e){return this._textdecoder||(this._textdecoder=new t.Text.Decoder),this._textdecoder.decode(new Uint8Array(e))}_consume_ZFILE_data(e,i){if(this._file_info)throw"PROTOCOL: second ZFILE data subpacket received";var o=i.get_payload(),g=o.indexOf(0),S=this._octets_to_string(o.slice(0,g)),w=this._octets_to_string(o.slice(1+g)).split(" "),R=w[1]&&parseInt(w[1],8)||void 0;R&&(R=new Date(R*1e3)),this._file_info={name:S,size:w[0]?parseInt(w[0],10):null,mtime:R||null,mode:w[2]&&parseInt(w[2],8)||null,serial:w[3]&&parseInt(w[3],10)||null,files_remaining:w[4]?parseInt(w[4],10):null,bytes_remaining:w[5]?parseInt(w[5],10):null};var L=new N(e.get_options(),this._file_info,this._accept.bind(this),this._skip.bind(this));this._current_transfer=L}_consume_ZDATA_data(e){if(!this._accepted_offer)throw"PROTOCOL: Received data without accepting!";if(!this._offset_ok){console.warn("offset not ok!"),_send_ZRPOS();return}this._file_offset+=e.get_payload().length,this._on_data_in(e),e.ack_expected()&&!e.frame_end()&&this._send_header("ZACK",t.ENCODELIB.pack_u32_le(this._file_offset))}_make_promise_for_between_files(){var e=this;return new Promise(function(i){var o={ZFILE:function(g){this._next_subpacket_handler=function(S){this._next_subpacket_handler=null,this._consume_ZFILE_data(g,S),this._Happen("offer",this._current_transfer),i(this._current_transfer)}},ZSINIT:function(g){e._next_subpacket_handler=function(S){e._next_subpacket_handler=null,e._consume_ZSINIT_data(S),e._send_header("ZACK"),e._next_header_handler=o}},ZFIN:function(){this._consume_ZFIN(),i()}};e._next_header_handler=o})}_consume_ZSINIT_data(e){this._attn=e.get_payload()}start(){if(this._started)throw"Already started!";this._started=!0;var e=this._make_promise_for_between_files();return this._send_ZRINIT(),e}_accept(e){this._accepted_offer=!0,this._file_offset=e||0;var i=this,o=new Promise(function(g){i._next_header_handler={ZDATA:function(w){this._consume_ZDATA(w),this._next_subpacket_handler=this._consume_ZDATA_data,this._next_header_handler={ZEOF:function(L){this._consume_ZEOF(L),this._next_subpacket_handler=null,this._make_promise_for_between_files(),g(),this._send_ZRINIT()}}}}});return this._send_ZRPOS(),o}_skip(){var e=this._make_promise_for_between_files();if(this._accepted_offer){if(!this._current_transfer)return;var i=(function(){this._accepted_offer=!1,this._next_subpacket_handler=null,this._make_promise_for_between_files()}).bind(this);Object.assign(this._next_header_handler,{ZEOF:i,ZDATA:(function(){i(),this._next_header_handler.ZEOF=i}).bind(this)})}return this._file_info=null,this._send_header("ZSKIP"),e}_send_ZRINIT(){this._send_header("ZRINIT",h)}_consume_ZFIN(){this._got_ZFIN=!0,this._send_header("ZFIN")}_consume_ZEOF(e){if(this._file_offset!==e.get_offset())throw"ZEOF offset mismatch; unimplemented (local: "+this._file_offset+"; ZEOF: "+e.get_offset()+")";this._on_file_end(),this._file_info=null,this._current_transfer=null}_consume_ZDATA(e){if(this._file_offset===e.get_offset())this._offset_ok=!0;else throw"Error correction is unimplemented."}_send_ZRPOS(){this._send_header("ZRPOS",this._file_offset)}_on_file_end(){this._Happen("file_end"),this._current_transfer&&(this._current_transfer._Happen("complete"),this._current_transfer=null)}_on_data_in(e){this._Happen("data_in",e),this._current_transfer&&this._current_transfer._Happen("input",e.get_payload())}},Object.assign(t.Session.Receive.prototype,{type:"receive"});var v={get_details:function(){return Object.assign({},this._file_info)},get_options:function(){return Object.assign({},this._zfile_opts)},get_offset:function(){return this._file_offset}};class m{constructor(e,i,o,g){this._file_info=e,this._file_offset=i||0,this._send=o,this._end=g}send(e){this._send(e),this._file_offset+=e.length}end(e){var i=this._end(e||[]);return e&&(this._file_offset+=e.length),i}}Object.assign(m.prototype,v);class N extends p{constructor(e,i,o,g){super(),this._zfile_opts=e,this._file_info=i,this._accept_func=o,this._skip_func=g,this._Add_event("input"),this._Add_event("complete"),this.on("input",this._input_handler)}_verify_not_skipped(){if(this._skipped)throw new t.Error("Already skipped!")}skip(){return this._verify_not_skipped(),this._skipped=!0,this._skip_func.apply(this,arguments)}accept(e){if(this._verify_not_skipped(),this._accepted)throw new t.Error("Already accepted!");switch(this._accepted=!0,e||(e={}),this._file_offset=e.offset||0,e.on_input){case null:case void 0:case"spool_array":case I:this._spool=[];break;default:if(typeof e.on_input!="function")throw"Invalid “on_input”: "+e.on_input}return this._input_handler_mode=e.on_input||I,this._accept_func(this._file_offset).then(this._get_spool.bind(this))}_input_handler(e){if(this._file_offset+=e.length,typeof this._input_handler_mode=="function")this._input_handler_mode(e);else{if(this._input_handler_mode===I)e=new Uint8Array(e);else if(this._input_handler_mode!=="spool_array")throw new t.Error("WTF?? _input_handler_mode = "+this._input_handler_mode);this._spool.push(e)}}_get_spool(){return this._spool}}Object.assign(N.prototype,v);const u={ZFILE:!0,ZDATA:!0};t.Session.Send=class extends t.Session{constructor(e){if(super(),e){if(e.NAME!=="ZRINIT")throw"First header should be ZRINIT, not "+e.NAME}else throw"Need first header!";this._last_header_name="ZRINIT",this._subpacket_encode_func="encode16",this._zencoder=new t.ZDLE,this._consume_ZRINIT(e),this._file_offset=0,this._start_keepalive_on_set_sender=!0}set_sender(e){return super.set_sender(e),this._start_keepalive_on_set_sender&&(this._start_keepalive_on_set_sender=!1,this._start_keepalive()),this}_get_header_formatter(e){return u[e]?"to_binary16":"to_hex"}_start_keepalive(){if(!this._keepalive_promise){var e=this;this._keepalive_promise=new Promise(function(i){e._keepalive_timeout=setTimeout(i,c)}).then(function(){e._next_header_handler={ZACK:function(){e._got_ZSINIT_ZACK=!0}},e._send_ZSINIT(),e._keepalive_promise=null,e._start_keepalive()})}}_stop_keepalive(){this._keepalive_promise&&(clearTimeout(this._keepalive_timeout),this._keep_alive_promise=null)}_send_ZSINIT(){var e=[];this._zencoder.escapes_ctrl_chars()&&e.push("ESCCTL"),this._send_header_and_data(["ZSINIT",e],[0],"end_ack")}_consume_ZRINIT(e){if(this._last_ZRINIT=e,e.get_buffer_size())throw"Buffer size ("+e.get_buffer_size()+") is unsupported!";if(!e.can_full_duplex())throw"Half-duplex I/O is unsupported!";if(!e.can_overlap_io())throw"Non-overlap I/O is unsupported!";if(e.escape_8th_bit())throw"8-bit escaping is unsupported!";this._zencoder.set_escape_ctrl_chars(!0),e.escape_ctrl_chars()||console.debug("Peer didn’t request escape of all control characters. Will send ZSINIT to force recognition of escaped control characters.")}_ensure_receiver_escapes_ctrl_chars(){var e,i=!this._last_ZRINIT.escape_ctrl_chars()&&!this._got_ZSINIT_ZACK;if(i){var o=this;e=new Promise(function(g){o._next_header_handler={ZACK:S=>{g()}},o._send_ZSINIT()})}else e=Promise.resolve();return e}_convert_params_to_offer_payload_array(e){e=t.Validation.offer_parameters(e);var i=e.name+"\0",o=[(e.size||0).toString(10),e.mtime?e.mtime.toString(8):"0",e.mode?(32768|e.mode).toString(8):"0","0"];return e.files_remaining&&(o.push(e.files_remaining),e.bytes_remaining&&o.push(e.bytes_remaining)),i+=o.join(" "),this._string_to_octets(i)}send_offer(e){if(t.DEBUG&&console.debug("SENDING OFFER",e),!e)throw"need file params!";if(this._sending_file)throw"Already sending file!";var i=this._convert_params_to_offer_payload_array(e);this._stop_keepalive();var o=this;function g(){o._next_header_handler={ZRPOS:function(w){t.DEBUG&&console.warn("Mid-transfer ZRPOS … implementation error?"),g()}}}var S=function(){var w=new Promise(function(R){o._next_header_handler={ZSKIP:function(){o._start_keepalive(),R()},ZRPOS:function(L){o._sending_file=!0,g(),R(new m(e,L.get_offset(),o._send_interim_file_piece.bind(o),o._end_file.bind(o)))}}});return o._send_header_and_data(["ZFILE"],i,"end_ack"),delete o._sent_ZDATA,w};return this._ensure_receiver_escapes_ctrl_chars().then(S)}_send_header_and_data(e,i,o){var g=this._create_header_bytes(e),S=this._build_subpacket_bytes(i,o);g[0].push.apply(g[0],S),t.DEBUG&&(this._log_header("SENDING HEADER",g[1]),console.debug(this.type,"-- HEADER PAYLOAD:",o,S.length)),this._sender(g[0]),this._last_sent_header=g[1]}_build_subpacket_bytes(e,i){var o=t.Subpacket.build(e,i);return o[this._subpacket_encode_func](this._zencoder)}_build_and_send_subpacket(e,i){this._sender(this._build_subpacket_bytes(e,i))}_string_to_octets(e){this._textencoder||(this._textencoder=new t.Text.Encoder);var i=this._textencoder.encode(e);return Array.prototype.slice.call(i)}_send_interim_file_piece(e){return this._send_file_part(e,"no_end_no_ack"),Promise.resolve()}_ensure_we_are_sending(){if(!this._sending_file)throw"Not sending a file currently!"}_end_file(e){this._ensure_we_are_sending(),this._send_file_part(e,"end_no_ack");var i=this,o=new Promise(function(g){i._sending_file=!1,i._prepare_to_receive_ZRINIT(g)});return this._send_header("ZEOF",this._file_offset),this._file_offset=0,o}_prepare_to_receive_ZRINIT(e){this._next_header_handler={ZRINIT:function(i){this._consume_ZRINIT(i),e&&e()}}}close(){var e=this._last_header_name==="ZRINIT";if(e||(e=this._last_header_name==="ZSKIP"),e||(e=this._last_sent_header.name==="ZSINIT"&&this._last_header_name==="ZACK"),!e)throw"Can’t close; last received header was “"+this._last_header_name+"”";var i=this,o=new Promise(function(g,S){i._next_header_handler={ZFIN:function(){i._sender(n),i._sent_OO=!0,i._on_session_end(),g()}}});return this._send_header("ZFIN"),o}_has_ended(){return this.aborted()||!!this._sent_OO}_send_file_part(e,i){this._sent_ZDATA||(this._send_header("ZDATA",this._file_offset),this._sent_ZDATA=!0);for(var o=0,g=e.length;;){var S=Math.min(o+a,g)-o,w=S+o>=g,R=e.slice(o,o+S);if(R instanceof Array||(R=Array.prototype.slice.call(R)),this._build_and_send_subpacket(R,w?i:"no_end_no_ack"),this._file_offset+=S,o+=S,o>=g)break}}_consume_first(){if(!this._parse_and_consume_header()&&this._input_buffer.join()==="67")throw"Receiver has fallen back to YMODEM."}_on_session_end(){this._stop_keepalive(),super._on_session_end()}},Object.assign(t.Session.Send.prototype,{type:"send"})})(ge);var dt=ge.exports;(function(b){var t=b.exports;Object.assign(t,X,dt);const c=21,h=[42,42,24,66,48],I=["to_terminal","on_detect","on_retract","sender"];class a{constructor(n,_,p,y){this._confirmer=_,this._denier=p,this._is_valid=y,this._session_type=n}confirm(){return this._confirmer.apply(this,arguments)}deny(){return this._denier.apply(this,arguments)}is_valid(){return this._is_valid.apply(this,arguments)}get_session_role(){return this._session_type}}t.Sentry=class{constructor(n){if(!n)throw"Need options!";var _=this;I.forEach(function(p){if(!n[p])throw"Need “"+p+"”!";_["_"+p]=n[p]}),this._cache=[]}_after_session_end(){this._zsession=null}consume(n){if(n instanceof Array||(n=Array.prototype.slice.call(new Uint8Array(n))),this._zsession){var _=this._zsession;if(_.consume(n),_.has_ended())_.type==="receive"?n=_.get_trailing_bytes():n=[];else return}var p=this._parse(n),y=n;if(p){let u=function(){return v._parsed_session===p},f=function(){if(!this.is_valid())throw"Stale ZMODEM session!";return p.on("garbage",v._to_terminal),p.on("session_end",v._after_session_end.bind(v)),p.set_sender(v._sender),delete v._parsed_session,v._zsession=p};!!this._parsed_session&&(this._parsed_session.type===p.type&&(y=[]),this._on_retract()),this._parsed_session=p;var v=this;this._on_detect(new a(p.type,f,this._send_abort.bind(this),u))}else{var m=this._parsed_session;this._parsed_session=null,m&&(y.length===1&&y[0]===67&&this._send_abort(),this._on_retract())}this._to_terminal(y)}get_confirmed_session(){return this._zsession||null}_send_abort(){this._sender(t.ZMLIB.ABORT_SEQUENCE)}_parse(n){var _=this._cache;for(_.push.apply(_,n);;){let p=t.ZMLIB.find_subarray(_,h);if(p===-1)break;_.splice(0,p);let y;try{y=t.Session.parse(_)}catch{}if(!y)break;return _.length===1&&_[0]===t.ZMLIB.XON&&_.shift(),_.length?null:y}return _.splice(c),null}}})(me);var lt=me.exports;(function(b){Object.assign(b.exports,lt)})(pe);var ht=pe.exports;const $=De(ht);class ft{constructor(t,c){K(this,"_socket");K(this,"_bidirectional");K(this,"_disposables",[]);this._socket=t,this._socket.binaryType="arraybuffer",this._bidirectional=!(c&&c.bidirectional===!1)}activate(t){this._disposables.push(q(this._socket,"message",c=>{const h=c.data;if(typeof h=="string"){const I=JSON.parse(h);t.write(Le.decode(I.data))}})),this._bidirectional&&(this._disposables.push(t.onData(c=>this._sendData(c))),this._disposables.push(t.onBinary(c=>this._sendBinary(c)))),this._disposables.push(q(this._socket,"close",()=>this.dispose())),this._disposables.push(q(this._socket,"error",()=>this.dispose()))}dispose(){this._disposables.forEach(t=>t.dispose())}_sendData(t){this._socket.readyState===1&&this._socket.send(t)}_sendBinary(t){if(this._socket.readyState!==1)return;const c=new Uint8Array(t.length);for(let h=0;h<t.length;++h)c[h]=t.charCodeAt(h)&255;this._socket.send(c)}}function q(b,t,c){return b.addEventListener(t,c),{dispose:()=>{c&&b.removeEventListener(t,c)}}}let U=null,H=null,B={rows:40,cols:150};function ut(){window.screen.height>870&&(B.rows=40),window.screen.height>1e3&&(B.rows=45),window.screen.height>1100&&(B.rows=50),window.screen.height<870&&(B.rows=30)}const pt=({id:b,ws:t,onCloseTodo:c})=>{const{enqueueSnackbar:h}=ue(),[I,a]=F.useState(!1),[r,n]=F.useState(!1),[_,p]=F.useState(0),[y,v]=F.useState(!1),m=(u,f,e)=>{e||(e={});const i=[];let o=0;for(let w=f.length-1;w>=0;w--){const R=f[w];o+=R.size,i[w]={obj:R,name:R.name,size:R.size,mtime:new Date(R.lastModified),files_remaining:f.length-w,bytes_remaining:o}}let g=0;function S(){const w=i[g];return w?(g++,u.send_offer(w).then(function(L){return e.on_offer_response&&e.on_offer_response(w.obj,L),L===void 0?S():new Promise(function(s){const k=new FileReader;k.onerror=function(x){throw console.error("file read error",x),"File read error: "+x};let l;k.onprogress=function(x){var T;if(x.target.result){if(l=new Uint8Array((T=x==null?void 0:x.target)==null?void 0:T.result,L.get_offset()),u.aborted())throw new $.Error("aborted");L.send(l),e.on_progress&&e.on_progress(w.obj,L,l)}},k.onload=function(x){var T;if(l=new Uint8Array((T=x==null?void 0:x.target)==null?void 0:T.result,L,l),u.aborted())throw new $.Error("aborted");L.end(l).then(function(){e.on_progress&&l.length&&e.on_progress(w.obj,L,l),e.on_file_complete&&e.on_file_complete(w.obj,L),s(S())})},k.readAsArrayBuffer(w.obj)})})):Promise.resolve()}return S()},N=u=>{u.length>0?(v(!0),m(H,u,{on_offer_response(f,e){console.log(e||`${f.name} was upload skipped`)},on_progress(f,e){const o=e.get_details().size;let g;o===0?g=100:g=Math.round(e.file_offset/o*100),console.log(`${g}%`)},on_file_complete(f){console.log(`${f.name} 上传成功`)}}).then(()=>{H==null||H.close(),a(!1),v(!1),t.send(`
`)})):(console.log("-------请选择文件"),v(!1))};return F.useEffect(()=>{ut();const u=new Ke.Terminal({rows:B.rows,cols:B.cols,convertEol:!0,cursorStyle:"underline",cursorBlink:!0,fontSize:14,tabStopWidth:4}),f=new ft(t),e=new Ve.FitAddon;switch(u.loadAddon(f),u.loadAddon(e),u.open(document.getElementById(b)),u.focus(),e.fit(),t.readyState){case WebSocket.CONNECTING:u.writeln("正在连接服务器...");break;case WebSocket.OPEN:u.writeln("服务器连接成功...");break}u.onResize(s=>{U&&(clearTimeout(U),U=null),U||(U=setTimeout(function(){t.send(JSON.stringify({cols:s.cols,rows:s.rows})),B={cols:s.cols,rows:s.rows},U=null},500))}),t.onopen=s=>{u.writeln("WebSocket服务器连接成功..."),t.send(JSON.stringify({cols:u.cols,rows:u.rows})),h(` WebSocket服务器连接成功: ${s.type}`,{autoHideDuration:3e3,variant:"success"})},t.onerror=s=>{console.log(s),h(` WebSocket服务器连接失败: ${s.type}`,{autoHideDuration:3e3,variant:"error"})},t.onclose=function(s){console.log("Connection closed.",s),u.dispose(),c&&c()},t.onmessage=s=>{try{R.consume(s.data)}catch{t.send(`
`)}};const i=(s,k)=>{const l=new Blob(s),A=URL.createObjectURL(l),x=document.createElement("a");x.style.display="none",x.href=A,x.download=k,document.body.appendChild(x),x.click(),document.body.removeChild(x)},o=s=>{},g=()=>{console.log("retract")},S=s=>{t&&t.send(new Uint8Array(s).buffer)},w=s=>{H=s.confirm(),(H==null?void 0:H.type)==="send"?a(!0):(H.on("offer",k=>{const l=k.get_details().bytes_remaining;let A=0;n(!0),k.on("input",x=>{A+=x.length,p(Math.ceil(A*100/l))}),k.accept().then(()=>{i(k._spool,k.get_details().name)})}),H.on("session_end",()=>{p(0),n(!1)}),H.start())},R=new $.Sentry({to_terminal:o,sender:S,on_detect:w,on_retract:g}),L=()=>{const s=Math.ceil(document.body.clientHeight/18-10);u.resize(B.cols,s),e.fit()};return window.addEventListener("resize",L),()=>{t.close(),u.dispose(),window.removeEventListener("resize",L)}},[]),C.jsxs(C.Fragment,{children:[C.jsx("div",{id:b}),C.jsxs($e,{open:I,onClose:()=>a(!1),"aria-labelledby":"file-browser",fullWidth:!0,maxWidth:"md",children:[C.jsx(qe,{style:{minHeight:"300px",display:"flex",flexDirection:"column",justifyContent:"center "},dividers:!0,children:C.jsx(Qe,{children:C.jsx(We,{type:"host",typeId:1,onBeforeUpload:()=>{a(!1)},customUploadFn:N,showUploadProgress:!1})})}),C.jsx(Ye,{children:C.jsx(V,{onClick:()=>a(!1),color:"primary",children:"关闭"})})]})]})},mt=(b,t)=>({...t,hostList:b.hostList,quickCommandList:b.quickCommandList}),bt={updateHostList:_e.getHostList,initQuickCommandAction:_e.initQuickCommandList},gt=je(b=>ze({root:{width:"100%",height:"100%"},ControlBox:{marginBottom:"20px",width:"100%",display:"flex",alignContent:"space-evenly",alignItems:"center",justifyContent:"flex-start"},Control:{width:"25%"},LinkButton:{marginTop:"12px",marginLeft:"40px",height:"45px",width:"90px",backgroundColor:b.palette.info[b.palette.type],"&:hover":{backgroundColor:b.palette.info.main}},LinkOffButton:{marginTop:"12px",marginLeft:"40px",height:"45px",width:"90px",marginRight:"40px",backgroundColor:b.palette.error[b.palette.type],"&:hover":{backgroundColor:b.palette.error.main}},sendButton:{marginTop:"12px",marginLeft:"40px",height:"45px",width:"90px",marginRight:"40px",backgroundColor:b.palette.success[b.palette.type],"&:hover":{backgroundColor:b.palette.success.main}},shellBox:{marginTop:"20px",width:"100%",height:"70%"}})),vt=({hostList:b,quickCommandList:t})=>{const{enqueueSnackbar:c}=ue(),h=gt(),[I,a]=F.useState(0),[r,n]=F.useState(""),[_,p]=F.useState(0),y=F.useRef("terminal"+new Date().getTime()),v=Pe();F.useEffect(()=>{const f=Number((v==null?void 0:v.id)||"0");f!==0&&(m(f),a(f))},[]);const m=f=>{!f||r||n(new WebSocket(`${et}ssh/${f}?cols=150&rows=40`))},N=()=>{r&&(c("正在关闭WebSocket连接...",{autoHideDuration:3e3,variant:"info"}),r.close(),n(""))},u=f=>{a(f.target.value)};return C.jsxs("div",{className:h.root,children:[C.jsxs("div",{className:h.ControlBox,children:[C.jsxs(fe,{className:h.Control,children:[C.jsx(ce,{children:"请选择主机"}),C.jsx(de,{labelId:"typeItem-select-label",id:"typeItem-select-label",value:I||"",onChange:u,children:b.map(f=>C.jsx(le,{value:f.id,children:`${f.name}: ${f.addr}`},f.name))})]}),C.jsx(V,{disabled:!I||!!r,className:h.LinkButton,startIcon:C.jsx(Ue,{}),onClick:()=>m(I),children:"连接"}),C.jsx(V,{disabled:!r,className:h.LinkOffButton,startIcon:C.jsx(Xe,{}),onClick:N,children:"断开"}),C.jsxs(fe,{className:h.Control,children:[C.jsx(ce,{children:"请选择快捷命令"}),C.jsx(de,{labelId:"typeItem-select-cmd",id:"typeItem-select-cmd",value:_||"",onChange:f=>{var e;p((e=f==null?void 0:f.target)==null?void 0:e.value)},children:t.map(f=>C.jsx(le,{value:f.id,children:`${f.name}`},f.id))})]}),C.jsx(V,{disabled:!r,className:h.sendButton,startIcon:C.jsx(Ge,{}),onClick:()=>{const f=t.find(e=>e.id===_);if(r&&f){if(f.append_cr){r==null||r.send(f.cmd+"\r");return}r==null||r.send(f.cmd)}},children:"发送"})]}),C.jsx("div",{className:h.shellBox,children:r?C.jsx(pt,{id:y.current,ws:r,onCloseTodo:()=>n("")}):C.jsx(Je,{errInfo:"请选择一个主机进行连接",errType:"network",imgStyle:{width:"400px",height:"400px"},variant:"h4"})})]})},xt=He.memo(vt,(b,t)=>b.hostList===t.hostList);function Y(){return[{label:"窗口",index:0}]}function Et(b,t){switch(t.type){case"update":return b.map(c=>c.index===t.index?{...c,[t.key]:t.payload}:c);case"add":return[...b,{label:"窗口",index:new Date().getTime()}];case"remove":return b.filter(c=>c.index!==t.index);case"reset":return Y();default:throw new Error}}const yt=({hostList:b,updateHostList:t,initQuickCommandAction:c,quickCommandList:h})=>{const[I,a]=F.useState(0),[r,n]=F.useReducer(Et,Y(),Y);F.useEffect(()=>{t(),c()},[]);const _=(v,m)=>{a(m)},p=()=>{n({type:"add"})},y=v=>{n({type:"remove",index:v})};return C.jsxs("div",{style:{width:"100%",height:"100%"},children:[C.jsxs(tt,{variant:"scrollable",scrollButtons:"auto",value:I,onChange:_,"aria-label":"上传文件",children:[r.map((v,m)=>C.jsx(rt,{label:C.jsxs("div",{style:{display:"flex",justifyContent:"space-around",width:"100%"},children:[C.jsx("span",{children:v.label+(m+1)}),C.jsx(he,{title:"关闭窗口",placement:"top-start",children:C.jsx(nt,{fontSize:"small",color:"error",onClick:()=>y(v.index)})})]}),...Me(v.index)},v.index)),C.jsx(he,{title:"新窗口",placement:"top-start",children:C.jsx(Be,{color:"primary",onClick:p,children:C.jsx(it,{})})})]}),r.map((v,m)=>C.jsx(st,{value:I,index:m,style:{height:"95%"},children:C.jsx(xt,{hostList:b,quickCommandList:h})},v.index))]})},ar=Fe(mt,bt)(yt);export{ar as default};
